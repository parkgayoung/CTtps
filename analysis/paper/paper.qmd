---
title: "Cultural Transmission and the Social Contexts of Technological Transitions during the Late Paleolithic of Korea"
author:
  - Gayoung Park:
      institute: uw
      correspondence: "yes"
      email: gayoungp@uw.edu
  - Ben Marwick:
      institute: uw
institute:
  - uw:
      name: Department of Anthropology, University of Washington
      address: Seattle, WA, USA
format: 
  docx:
    reference-doc: "../templates/template.docx" # Insert path for the DOCX file
execute:
  echo: false
  warning: false
  message: false
  comment: "#>"
  fig-path: "../figures/"
  fig-dpi: 600
  cache: false
editor: visual
date: now
date-format: long
title-block-published: "Last updated" 
filters:
  - ../templates/scholarly-metadata.lua
  - ../templates/author-info-blocks.lua
  - ../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style

abstract: |
  The onset of the Late Paleolithic period in Korea, represented by the appearance of stemmed points and blades, was a key event in the dispersal of modern humans in Northeast Asia. Previous studies have mainly focused on possible origin locations of these new technologies. The specific cultural processes of the appearance of stemmed points and blades have rarely been considered. We explore these cultural processes by applying a cultural transmission framework to investigate the social contexts of the emergence of these new technologies. Our main question is: what was the dominant mode of cultural transmission during this time of technological innovation in the Korean Late Paleolithic? Following Bettinger and Eerkens [-@bettinger1999point], we evaluated models of guided variation and indirect bias using data from Korean assemblages containing stemmed points. To evaluate these models and understand the transmission processes, we computed correlation coefficients and coefficients of variation (CV). We found that information about the new technology was likely transmitted via guided variation with small contribution from indirect bias. Some attributes, including length and width, were transmitted with less variation while other attributes have more variation. Our results suggest that the dominant mode of cultural transmission for the earliest stemmed points was guided variation. A slight shift in the social context of transmission towards indirect bias was observed in the later chronological phase. We assume that individuals or groups developed stemmed points by experimenting with existing blade technologies and then copied crucial parts of a successful model to ensure the quality to optimize tool usage. As a result, the shape of stemmed points became more standardized among their social groups.    
  
keywords: |
  Stemmed points; Korean Paleolithic; Cultural Transmission; Learning process, Copying errors, Transmission Biases, Guided variation, Indirect bias
---

## Introduction {.unnumbered}

The application of evolutionary theory to archaeological research has been fruitful for the study of technological transitions and related human behaviors in the remote past [@dunnell1980evolutionary; @lipo1997population; @bettinger1997rediscovering; @bettinger1999point; @mesoudi2008cultural]. Archaeologists have used evolutionary theories and methods to get insights into human behavioral ecology, cultural transmission, and artifact phylogenetics in the past [@riede2010isn; @o2017dual; @garvey2018current]. In this paper, we use cultural transmission theory to investigate technological transitions during the Korean Late Paleolithic (40-35 ka). The primary technological innovation of this period was the introduction of stemmed points and blades. These new lithic technologies may represent the first arrival of modern humans in this region, and thus, they may also mark an important event in human dispersal through East Asia [@seong2009emergence]. Previous studies on Korean stemmed points have mostly focused on where these new technologies may have originated, connecting Korea with global patterns of modern human dispersal [@seong2008tanged; @bae2010origin; @bae2017origin]. There are, however, largely unanswered questions about the specific cultural processes and social contexts of this technological change in Korea. Our study explores the social contexts in which new technologies emerged in the Korean Late Paleolithic, using evolutionary theory to make inferences about cultural transmission from artifact measurements. Our main question is: What was the dominant mode of cultural transmission for technological innovation in the Korean Late Paleolithic? We also ask: Did the mode of cultural transmission vary over time and space? We consider three possible modes of cultural transmission: guided variation (trial and error), indirect bias (copying others), or a combination of the two. The results of this study have implications for determining whether these novel technologies originated outside of the Korean Peninsula or if they were locally and independently developed.

## The Late Paleolithic of the Korean Peninsula {.unnumbered}

The emergence of stemmed points marks the beginning of the Late Paleolithic period in Korea around 40-35 ka BP. A stemmed point is a projectile point made out of an elongated flake or blade with a slight retouch on the proximal end to the shape of an acute tip, and on the distal end to make a stem, which connects to a shaft. Stemmed points were the first composite tool types to appear on the Korean Peninsula, and were a symbol of new hunting strategies there and in adjacent regions [@seong2008tanged; @lee2019were]. A number of technological innovations are evident on stemmed points, including blade technology, multiple manufacturing stages, and evidence of resharpening and reusing, which were rarely seen earlier [@chang2013human; @bamforth2009projectile; @seong2015diversity]. Currently, the oldest stemmed points in Northeast Asia are from the Yonghodong site in Korea, dating back to 38.5 ka BP [@seong2008tanged; @seong2015diversity; @bae2012nature]. Following their appearance in Korea, stemmed points spread to the Japanese archipelago [@chang2013human].

Previous studies of the Late Paleolithic technological transitions in Korea have mainly focused on the possible origin locations of stemmed points as part of the discussion of the timing and routes of modern human dispersal in eastern Asia. The debate about the origin of stemmed points can be summarized into two competing models: *in situ* evolution [@seong2009emergence] and heterogenic migration [@bae2010origin]. The *in situ* model claims that stemmed points and other Late Paleolithic assemblages, including blade industries, autonomously emerged in the Korean peninsula as a form of convergent evolution [@seong2006structure; @seong2008tanged; @seong2009emergence]. To support his claim, @seong2009emergence examined the blade-to-flake ratios of stone artifact assemblages in South Korea. In his view, the blade industry represents a new technology, while flakes indicate a continuously-used existing one. He argues that the increased ratio of blades in stone artifact assemblages during the Late Paleolithic shows an expansion of the new technology after its local invention. In addition, Seong claims that increased numbers of stemmed points over time, and standardization of their shape, supports the prominance of gradual, local, evolutionary processes in the emergence of new technologies.

By contrast, the migration model contends that the new blade industry includes stemmed points, and the earlier flake tool tradition, including large cores, polyhedrals, choppers, and handaxes, originated outside of Korea [@bae2010origin; @bae2012nature; @bae2013early]. While the *in situ* model claims that the heterogenic character is the result of indigenous development, the migration model proposes that the heterogeneity is the result of the continuous influx of modern human populations from both north and south. Specifically, the blade technology is claimed to have been introduced from Siberia, Mongolia, or other regions of northeast China following the Liaohe and Sunghe rivers around 35 ka BP, while the simple flake-tool tradition came from southern China [@bae2013early]. Bae uses @shi2005chromosome's genetic studies of the Y chromosome to support the southern route, showing that the O3-M122 M122 haplotype originated from southern East Asia and moved to northeastern Asia, including Korea, at 30-25 ka BP. @bae2012nature assume this southern migration could be related to paleoenvironmental fluctuations during the MIS 3 to 2 transition, which made the Yellow Sea/West Sea region open.

@lee2013current argues that the transition to the Korean Late Paleolithic might be more complicated than either models of migration or *in situ* development. He partly agrees with the *in situ* model that simple flake tools had continuously been used in Korea as the result of ancestor-descendant relationships under conditions of low effective population size. With regard to the blade industry, he claims that the low degrees of uniformity and small quantities of blade-associated toolkits indicate an origin outside of Korea, perhaps resulting from trade or migration. We explore these three options, *in situ*, migration, and a mixture of the two, by measuring transmission biases in assemblages of stemmed points.

## Cultural transmission and transmission biases {.unnumbered}

To measure transmission biases in tool-making, we draw on Darwinian evolutionary theory. This body of theory has aided archaeologists in understanding a variety of technological innovations and related human behaviors [@dunnell1980evolutionary; @richerson1992cultural; @lipo1997population; @bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @mesoudi2008cultural; @crema2023cultural; @Prentiss_2019]. Cultural evolutionary approaches have been effective at explaining cultural changes using mechanisms of inheritance, variation-generating processes, and selection. These mechanisms are similar to biological evolution, but in cultural systems they have unique and distinctive properties [@Creanza_Kolodny_Feldman_2017; @Claidiere_Scott_Phillips_Sperber_2014; @Mesoudi_Whiten_Laland_2004; @Acerbi_Mesoudi_2015]. Social transmission strongly affects these key evolutionary processes [@Whiten_2017] and can occur through various learning processes, such as stimulus enhancement, emulation, imitation, and teaching [@o2000applying; @schillinger2014copying]. We focus here on how different social contexts can result in different modes of social transmission of tool-making skills among hunter-gatherer populations.

Cultural transmission theory holds that information about social and technological behaviors is acquired through interaction with other individuals and the environment [@boyd1988culture; @richerson1992cultural]. Individuals learn by themselves (e.g. trial and error) or from each other by sharing information. Information can be modified (also known as 'biased') depending on an individual's transmission context and cultural repertoire [@richerson2008not]. Modification of information can occur by recombination, loss, or partial alteration [@eerkens2005cultural; @o2017dual]. These transmission biases can be important loci of changes in material culture, and can be influenced by the social contexts of cultural transmission [@heyes1994social; @eerkens2007cultural; @lycett2015cultural; @creanza2017cultural; @kendal2018social]. These biases include guided variation (where individuals learn new behaviors through trial and error), content-based bias (where some aspect of the transmitted instructions, such as cultural preferences, makes them more likely to be adopted), frequency-based bias (where an individual is biased to choose particular behaviors based on their perceived frequency in the population, such as extremely popular or rare behaviors), and indirect bias (where a behavior is transmitted because of its association with other attributes, such as the prestige or skill of other individuals) [@boyd1988culture; @richerson1992cultural; @o2017dual; @richerson2008not].

Bettinger and Eerkens [-@bettinger1997evolutionary; -@bettinger1999point; -@eerkens2008cultural] have shown how two of these biases can be identified in stone artifact assemblages. Their research focused on the metric variables of stone points during the introduction of bow and arrow technology in the Great Basin around AD 300-600. They equated guided transmission (where individuals learn about new behaviors through trial and error) with high metric variation and low correlation between metric attributes. Conversely, they inferred indirect bias (where a behavior is transmitted because of its association with other attributes, such as the prestige or skill of other individuals) from less variation and more correlated variables. They found that artifacts in the new bow and arrow technology in eastern California have low correlations of basal width and mass, which they interpreted as a result of guided transmission dominating the introduction and spread of these tools. Based on these results, they inferred that eastern California had a social context of distant and unfamiliar neighbors with little direct contact between groups. In this context of limited contact, they argue that the new technologies developed largely by trial and error. On the other hand, in central Nevada they found that metric variables were highly correlated, and concluded that the bow and arrow was introduced and spread by indirect bias.

Following Bettinger and Eerkens' framework, @garvey2018current used simulation to explore the degree of standardization represented by coefficient of variation (CV) values of projectile points from the US Southwest and westernmost southern High Plains. Garvey measured CV values for weight, thickness, width and length on two types of projectile points, Washita and Fresno points, from the Henderson site in southeastern New Mexico, USA. She then computed simulated CV values according to three scenarios of different levels of transmission fidelity (i.e. CV = 10%, 5%, and 3%). The observed metrics of archaeological projectile points are closest to simulated metrics with 3% CV, which represents "extremely high-fidelity copying." A CV of 3% is close to the Weber fraction for manually made human artifacts, that is, the threshold of human visual perception, with variation below this value being too subtle for people to notice [@eerkens2000practice]. Garvey's work demonstrates how the cultural transmission of tool-making behaviors can be measured, simulated, and interpreted from the archaeological record.

Garvey and Bettinger and Eerkens inferred transmission processes from material culture because they were unable to observe them directly. Direct observations have been reported by @mesoudi2008cultural, who conducted experimental research using groups of undergraduate students to test the underlying assumptions of Bettinger and Eerkens' study. They simulated model-based bias in projectile point-making by providing the design of a model and information about the model's prior success to their research participants. They also simulated guided variation by allowing their participants to explore their own designs. They observed that the majority of participants who were able to choose from the previous design ultimately copied the most-successful model. Metric attributes of projectile points made when copied from successful models were more highly correlated than attributes of points made by trial and error. Mesoudi and O'Brien's experimental results are important because they confirm the robustness of previous assumptions about cultural transmission biases, and validate the connection between material culture variation and cultural transmission biases.

## Modeling the social context of the appearance of stemmed points in the Late Paleolithic of Korea {.unnumbered}

Inspired by Bettinger and Eerkens' approach, we use two contrasting transmission modes, guided variation and indirect bias, to investigate the spread of stemmed point technology during the Korean Late Paleolithic period. We propose a spectrum on which we can locate foraging groups and how they started to make stemmed points, depending on their degree of social isolation or social connectedness. On one end of the spectrum we have socially isolated groups who made stemmed points through guided variation; and on the other end of the spectrum, we have socially connected groups whose knowledge of stemmed points derived from transmission processes dominated by indirect bias.

To contextualize this further, on one end of the spectrum we have socially isolated groups who stayed in physically remote places apart from other groups, or had unfamiliar neighbors with limited contact between groups. Our assumption for this social context is that individuals or groups acquired the technology of stemmed points by modifying existing flake tool forms through trial-and-error processes to solve problems relating to resource procurement (cf. Seong's *in situ* model). If this social context was prevalent, we predict that this trial and error behavior could have left a distinctive signature on the metric variables of the stemmed points. If trial and error was the dominant bias in the transmission of knowledge about how to make stemmed points, we expect that the morphological attributes on a stemmed point will be poorly correlated and show high variation within assemblages and between sites.

On the other end of the spectrum, we have socially connected groups that occupied places close to other groups or had regular contact with them. Relatively high degrees of social connectivity provide frequent opportunities for observing others and acquiring information. Individuals or groups learned the technology of stemmed points by copying a model from another individual or group. In this scenario, it is likely that the model, or ideal, stemmed point has been highly successful and frequently chosen, and learners copy all information about the point design as a package. This implies a small number of locations, or a single point (perhaps from a source external to the Korean peninsula, cf. Bae's migration model), where stemmed points first appeared and then spread from. In this social context, indirect bias is the dominant influence on the transmission of lithic technology. If indirect bias was prominent in the Korean Paleolithic, we expect that stemmed points would be more standardized, attributes on the stemmed points would be more correlated, and assemblages from multiple sites would exhibit less variance between and within them.

## Materials and methods {.unnumbered}

```{r}
#| label: summary-of-data

library(tidyverse)
library(ggplot2)
library(ggbeeswarm)

# import the cleaned data ready to work on
load(here::here("analysis/data/derived_data/data_main.RData"))

# how many stemmed artifacts per site?
stemmed_points_per_site <-
df_full_sitename %>%
  dplyr::count(full_sitename) %>%
  arrange(desc(n))

# how many assemblages do we use?
stemmed_points_ass <- df_sitename %>%
  unite(col = "site_phase",
        c(sitename,
          SPstage.Stage),
        sep = "_") %>%
  dplyr::select(-SPstage.Raw_material) %>%
  dplyr::count(site_phase)

# prepare some values to use in the text below
total_number_of_sp <- sum(stemmed_points_per_site$n)
total_number_of_sites <-nrow(stemmed_points_per_site)
total_number_of_assemblages <- nrow(stemmed_points_ass)
```

### Materials and stemmed points chronology

After the first discovery of stemmed points at the Seokjangri site in the 1960s, more than 450 have been found in nearly 30 sites across Korea (@fig-map) [@Sohn_1967; @lee2019were; @Chong_2021]. While most sites contain only a few points, a few sites have many more, such as Suyanggae (n = 55), Jingeuneul (n = 99), and Yongsandong (n = 38) [@Kim_2017]. Among these stemmed points, we selected those that were unbroken from the tip to the stem. We excluded artifacts that were recorded as stemmed points but lacked a stem. This resulted in a sample of `r total_number_of_sp` stemmed points from `r total_number_of_assemblages` assemblages unearthed from `r total_number_of_sites` sites spanning the period 40-17 ka (@tbl-sp-number). The images of the stemmed points were obtained through published excavation reports and direct photography during our research in local museums. We defined multiple assemblages from a site where artifact-bearing deposits were separated by culturally sterile deposits, or where distinct artifact-bearing stratigraphic units could be identified by major differences in the texture, color, and composition of the sedimentary deposits.

\newpage

```{r}
#| label: fig-map
#| fig-cap: "Korean Paleolithic sites mentioned in this study."
#| fig-width:   4.45
#| fig-height:  4.5

# This script draws the map, this is figure 1 in the paper.

korean_archaeological_site_locations <-
  readr::read_csv(here::here("analysis/data/raw_data/sitelocation.csv"))

korean_archaeological_site_locations <-
  tibble::rowid_to_column(korean_archaeological_site_locations, "ID")

# load map tiles we previously saved, we got these using the code in 
# 000-download-map-tiles.R

library(ggrepel)
# devtools::install_github('3wen/legendMap')
library(legendMap)
library(sp)
library(ggmap)

# load map tiles we previously saved
map <- readRDS(here::here("analysis/data/raw_data/map_tiles.rds"))

# map with site names next to the points
map_of_sites <-
  ggmap(map)  +
  geom_point(data = korean_archaeological_site_locations,
             aes(long_dd ,
                 lat_dd),
             colour = "red",
             size = 2) +

# label points with site name
  geom_text_repel(data = korean_archaeological_site_locations,
                  aes(long_dd ,
                      lat_dd,
                      label = full_sitename),
                  size = 2,
                  bg.color = "white",
                  bg.r = 0.15) +
  theme_minimal(base_size = 6) +
  labs(x = "Longitute",
       y = "Latitude") +
  legendMap::scale_bar(
    # edit these numbers to select a suitable location
    # for the scale bar where it does not cover
    # important details on the map
    lon = 124.5,
    lat = 33.5,
    legend_size = 2,
    # distance of one section of scale bar, in km
    distance_lon = 50,
    # height of the scale bar, in km
    distance_lat = 5,
    # distance between scale bar and units, in km
    distance_legend = 20,
    # units of scale bar
    dist_unit = "km",
    # add the north arrow
    orientation = TRUE,
    # length of N arrow, in km
    arrow_length = 60,
    # distance between scale bar & base of N arrow, in km
    arrow_distance = 50,
    # size of letter 'N' on N arrow, in km
    arrow_north_size = 10) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank())

# inset world map, from
# https://stackoverflow.com/a/62104396/1036500
library(maps)
library(magrittr)
library(maptools)
library(raster)

#Defining a general CRS
mycrs <- "+proj=longlat +datum=WGS84 +no_defs"

#Using the original maps package, then converting map into SpatialPolygons object
world <- maps::map("world", fill=TRUE,  plot = FALSE) %$%
  maptools::map2SpatialPolygons(., IDs=names,proj4string=CRS(mycrs))

#The resulting map has self intersection problems so any further operation reports errors; using buffers of width 0 is a fast fix
while(rgeos::gIsValid(world)==FALSE){
  world <- rgeos::gBuffer(world, byid = TRUE, width = 0, quadsegs = 5, capStyle = "ROUND")
}

#Dissolving polygon's limits
world <- raster::aggregate(world)

#Plotting. I add theme_void to your code to erase any axis, etc
worldplot <-
  ggplot() +
  geom_polygon(data = world,
               aes(x=long, y=lat,
                   group=group),
               fill='NA',
               color='black',
               size=0.1) +
  annotate("rect",
           xmin = 118,
           xmax = 137,
           ymin = 28,
           ymax = 47,
           fill = NA,
           colour = "red",
           size = 0.5
  ) +
  theme_void() +
  coord_fixed(1) +
  labs(x = "", y = "") +
  labs(x = NULL, y = NULL, title = NULL) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme(panel.background = element_rect(fill = "white"),
        panel.border = element_blank(),
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())

# combine site map and inset map
library(cowplot)
ggdraw() +
  draw_plot(map_of_sites) +
  draw_plot(plot = worldplot,
            x = 0.45, # x location of inset placement
            y = -0.27, # y location of inset placement
            width = .6, # Inset width
            height = .75, # Inset height
            scale = 0.5 # Inset scale
  ) +
  theme(panel.background = element_rect(fill='white', colour="white"),
        plot.background = element_rect(fill='white', colour="white"))

# ggsave(here::here("analysis/figures/fig-map.png"),
#        width = 4,
#        height = 4.5,
#        units = "in")

```

\newpage

```{r}
#| label: tbl-sp-number
#| tbl-cap: Total number of stemmed points found in sites and the number of stemmed points we used in the research. We excluded broken and unclear artifacts.

here::here("analysis/data/raw_data/site-total-artifacts.csv") %>% 
  read_csv() %>% 
  knitr::kable(.)

```

\newpage

To analyze morphological change over time, we used previously developed chronologies that identify three phases in the Korean Late Paleolithic [@seong2015diversity; @Park_2013]. These chronologies were constructed based on radiocarbon ages; assemblages without radiocarbon ages were classified by blades, stemmed point blanks, and toolkit composition. Following these previous chronological schemes, we divided the Korean Late Paleolithic assemblages into three chronological phases: 1) assemblages with stemmed points made out of flakes and no blades, 2) assemblages with stemmed points made out of blades or flakes and the existence of blades, and 3) assemblages with stemmed points made out of blades and the existence of micro-blades (@tbl-korean-chronology). Applying this division is necessary because some sites such as Yonghodong, Goryeri, Jungmal, and Mungyeong have no radiocarbon ages. Inferring approximate ages for these sites by analogy to the technological sequences at sites with dates is necessary for making maximal use of the available archaeological data to increase our sample size. We arranged our `r total_number_of_assemblages` assemblages containing stemmed points into these three phases to facilitate observations of change over time.

```{r}
#| label: tbl-korean-chronology
#| tbl-cap: Korean Late Paleolithic Chronology edited based on Seong [-@seong2015diversity] and Park [-@Park_2013]. SP = stemmed point

here::here("analysis/data/raw_data/Korean-paleolithic-chronology.csv") %>% 
  read_csv() %>% 
  knitr::kable(.)

```

\newpage

Panel A of @fig-raw-materials-by-phase summarizes the amount of stemmed points in each chronological phase, and the distribution of raw materials across the phases. We exclude Phase 1 from our analyses below because we consider the sample size too small to compute reliable correlations and CVs. Shale is the dominant raw material in both Phase 2 and 3. In Phase 3 there is an increase in the proportion of porphyry, driven largely by finds from Yongsangdong, and other raw materials. Panel B of @fig-raw-materials-by-phase shows the count of stemmed points by raw material type in assemblages with more than five stemmed points. Much of the raw material diversity comes from isolated finds, with those assemblages containing more than five points, showing high homogeneity in raw materials.

```{r}
#| label: fig-raw-materials-by-phase
#| fig-cap: "A: Three chronological phases of the Korean Late Paleolithic, and frequencies of stemmed points and distribution of raw materials in each phase. B: Frequencies of stemmed points by assemblage and raw material, for assemblages with five or more stemmed points."
#| fig-height: 4

df_full_sitename_fct <- 
df_full_sitename %>% 
  mutate(SPstage.Raw_material = factor(SPstage.Raw_material))

#Create a custom color scale
library(RColorBrewer)
myColors <- 
  brewer.pal(length(unique(df_full_sitename_fct$SPstage.Raw_material)),
             "RdBu")
names(myColors) <- levels(df_full_sitename_fct$SPstage.Raw_material)
colScale <- scale_fill_manual(name = "Raw material",
                                values = myColors)

p1 <- 
ggplot(df_full_sitename_fct) +
  aes(SPstage.Stage,
      fill = SPstage.Raw_material) +
  geom_bar() +
  theme_bw() +
  labs(fill = "Raw material",
       x = "Chronological Phase") +
  theme(legend.position = "top",
        legend.key.size = unit(0.5, 'cm'), #change legend key size
        legend.key.height = unit(0.5, 'cm'), #change legend key height
        legend.key.width = unit(0.5, 'cm'), #change legend key width
        legend.title = element_text(size=8), #change legend title font size
        legend.text = element_text(size=6)
        ) +
colScale

p2 <- 
  df_full_sitename_fct %>%
  mutate(SPstage.Stage = paste0("Phase ", SPstage.Stage)) %>% 
  group_by(full_sitename) %>% 
  filter(n() > 5) %>% 
    ggplot() +
    aes(full_sitename,
        fill = SPstage.Raw_material) +
    geom_bar() +
    facet_wrap(~ SPstage.Stage) +
  theme_bw () +
  labs(fill = "Raw material",
       x = "Site") +
 theme(legend.position = "none",
       axis.text.x = element_text(size = 5)  ) +
  scale_x_discrete(guide = guide_axis(n.dodge= 2.3)) +
   colScale

library(cowplot)
plot_grid(p1, p2,
          ncol = 1,
          rel_heights = c(1.5, 0.75),
          labels = c("A", "B"))

# ggsave(here::here("analysis/figures/fig-raw-materials-by-phase.png"),
#        width = 4,
#        height = 3,
#        units = "in")

```

\newpage

### Methods

Following the metric attributes used in previous studies of cultural transmission and projectile points, i.e. maximum length and width [@bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @garvey2018current], we examined variations in shape and the relationship between each attribute using morphological attributes on stemmed points (@fig-labelled-schematic). We obtained our morphological attribute data from landmark analysis of digitized images of stemmed points. Compared to traditional caliper measurements, morphometric data yield easily interpretable numerical and visual outcomes [@buchanan2010geometric; @thulman2012discriminating; @cardillo2016environment; @petvrik2018shape; @macleod2018quantitative; @okumura2019archaeology; @suarez2019life]. We did not include weight and thickness because these measurements were not available to us. For the landmark analysis, we placed 11 landmarks on the outline of each stemmed point and calculated distances between landmark coordinate pairs to derive attributes for statistical analysis. The landmarks we recorded are described in @tbl-landmark-abbreviations and shown in @fig-labelled-schematic. Using the point tool in ImageJ [@schneider2012nih], we captured the landmarks from images of the artifacts, and exported them as XY coordinate data for further analysis.

\newpage

```{r}
#| label: fig-labelled-schematic
#| fig-cap: Stemmed point from Yongsandong site with landmarks showing the attributes considered in this study and further research
#| out-width: "300px"

knitr::include_graphics(here::here("analysis/figures/hand-made-figures/ISKM-talk-2021-cut.png"))

```

\newpage

```{r}
#| label: tbl-landmark-abbreviations
#| tbl-cap: Description of artifact landmarks used in this study

here::here("analysis/data/raw_data/table-of-landmark-abbreviations.csv") %>% 
  read_csv() %>% 
  knitr::kable(.)

# to ensure we don't have any copy-paste errors 
# Correlation threshold
threshold_value_cor <- 0.5

# CV threshold
threshold_value <- 25
```

\newpage

Following @bettinger1999point we computed Pearson's correlation coefficient for all attributes on the stemmed points. High correlations between artifact attributes were proposed by @bettinger1999point as a key indicator of indirect bias during cultural transmission. It is based on the assumption that artifact-making was transmitted in packages of traits inherited from socially successful individuals who were role models. In their work, @bettinger1999point interpreted correlation coefficient values around `r threshold_value_cor` and higher as evidence of indirect bias, and lower values as evidence of guided variation. In this research, we examine the correlation between attributes and explore other variables, such as different phases, raw materials and assemblages.

To complement the correlation measurements, we chose Coefficient of Variation (CV) to measure the variation among the measurements of the stemmed points. The CV is determined by the ratio of the standard deviation to the mean and is usually expressed as a percentage. The method has been used in various disciplines to calculate standardization, precision, equality, homogeneity, etc. [@ng2006performance; @panichkitkosolkul2009improved; @panichkitkosolkul2013confidence; @wang2020standardization]. In archaeological studies, CV has been applied to measure the variation between artifacts and to test hypotheses about cultural evolutionary processes, including distinguishing between the types of learning biases affecting cultural transmission [@eerkens2001techniques; @eerkens2005cultural; @schillinger2014copying; @garvey2018current]. As a guide to interpreting CV values, @eerkens2001techniques claim that CV values over 57.7% are the result of random production. CV values below 1.7% are the byproduct of using a scale or template. Among all the various artifacts for which @eerkens2001techniques summarized CV values, the most comparable case to the stemmed points examined here was Great Basin projectile points, whose CV values range from 6-55%, with an average of 22%. Similarly, projectile points from the US Southwest have CV values ranging from 11% to 33% [@garvey2018current].

Sample size can impact the accuracy of CV estimates [@toebe2018sample; @kelley2007sample; @vanpool2011quantitative]. In previous archaeological studies, sample sizes for CV values have varied from five to more than a thousand artifacts [@bettinger1999point; @garvey2018current; @costin1995standardization; @wierer2013variability; @kvamme1996alternative; @rivals2009new]. A variety of methods are available for improving the reliability of CV measurements when using small samples. @vanpool2011quantitative, for instance, proposed a "corrected CV" for smaller samples (i.e. n\<25). Statistical research has resulted in several methods for computing confidence intervals on CVs to show uncertainties related to sample size [@koopmans1964confidence; @miller1991asymptomatic; @sharma1994asymptotic; @mckay1932distribution; @vangel1996confidence; @curto2009coefficient; @banik2011estimating; @panichkitkosolkul2013confidence; @mahmoudvand2009two; @gulhar2012comparison]. Although we have a total of `r total_number_of_sp` artifacts, most of our analyses involve comparisons of smaller subsets. For example, we compared samples of less than 25 pieces in order to explore temporal and regional patterns. Given these relatively small sample sizes in our study, we used the corrected CV formula of @vanpool2011quantitative, which we have implemented here in a function in the R programming language for others to use. We also computed confidence intervals using the method proposed by @sharma1994asymptotic to be transparent about the precision of our results [@kelley2007sample; @albatineh2014confidence].

One limitation of previous work is the absence of a clear threshold value for interpreting CV values in terms of different transmission biases. @bettinger1999point did not identify a threshold for CV values to distinguish guided variation from indirect bias. However, one can be inferred from their data. We used data from @bettinger1999point to calculate CV values of Rosegate points from Monitor Valley, California, which were claimed by Bettinger and Eerkens to result from indirect bias. With the exception of weight, the CVs for metric attributes on Rosegate points ranged from 17% to 24%. Based on these values, we propose `r threshold_value`% as an approximate threshold to distinguish between guided variation from indirect bias. We have three reasons to believe the higher side of the CV range of Rosegate points is appropriate as a threshold value. First, variation is generated by small errors that are transmitted between individuals and the errors get bigger through generations [@eerkens2005cultural]. The duration of the transmission process for stemmed points is much longer (in the order of thousands of years) than in the case of Rosegate (in the order of hundreds of years in the Fremont region) [@bischoff2021rosegate]. Second, the errors are likely to vary by raw materials. Some raw materials, such as clay for pots, are easier to control variation in while less controllable materials such as stone for flaked stone artefacts are likely to have higher CV values because of the relatively unpredictable nature of flaking [@eerkens2001techniques]. We assume that Rosegate projectile points were made from more finer-grained raw materials such as flint, compared to the raw materials for Korean stemmed points, which include shale, rhyolite, porphyry, etc. (@fig-raw-materials-by-phase). Third, the corrected CV calculation for small sample sizes that we are using tends to result in slightly higher values compared to standard CV values [@vanpool2011quantitative]. Given the tentative identification of this threshold value, we assume that CV values that are higher than `r threshold_value`% likely represent guided variation (trial and error) while CV values less than `r threshold_value`% likely reflect indirect bias (copying from a prestigious or skilled individual).

All data preparation, analyses and visualization were computed in the R environment [@RCoreTeam]. Our R code and data, including the original artifact images, are fully and openly available in our compendium [@Marwick2018compendium] online at https://doi.org/10.17605/osf.io/eb8mx to enable transparency, reproducibility, and reuse [@marwick2017computational].

## Results {.unnumbered}

### Correlation coefficients

Our results show positive correlations between attributes throughout the Late Paleolithic (Panel A of @fig-corr-analysis). Some relationships such as body length (BL) and maximum length (ML) have stronger correlations (i.e. darker-blue points) than others (i.e. lighter-blue or almost invisible points). To understand temporal patterns in the modes of cultural transmission, we grouped our assemblages into the three Korean Late Paleolithic chronological phases summarized in @tbl-korean-chronology. Among the three chronological phases, we excluded Phase 1 from our analysis because there are only two complete stemmed points from Yonghodong and Sachang that belong to this phase.

Panel D of @fig-corr-analysis shows that the correlations between attributes became stronger over time. The median correlation value for Phase 2 is much lower than `r threshold_value_cor`, which @bettinger1999point interpreted as a threshold to distinguish between transmission biases, while the Phase 3 median is close to this threshold value. We interpret Phase 2 as evidence of guided variation and Phase 3 a mixture of guided variation and of indirect bias.

```{r}
#| label: fig-corr-analysis
#| fig-cap: "Correlation analysis by chronological phases in the Korean Late Paleolithic period. A. Correlation coefficient between attributes for all periods. B. Correlation coefficient between attributes for Phase 1. C. Correlation coefficient between attributes for Phase 2. The individual point represents correlation between two attributes. Some points are invisible due to their weak relationship. D. Correlation coefficient for the second and third chronological phases. The grey points represent correlation between two attributes."
#| fig-width: 7
#| fig-height: 5

library(corrr)

# correlation of all artifacts
df_sitename_corr <- 
  df_sitename %>%
  dplyr::select(-sitename, -SPstage.Stage, -SPstage.Raw_material) %>% 
  correlate() %>% 
  shave() 

all_corr_plot <- rplot(df_sitename_corr, 
                       print_cor = TRUE,
                       legend = FALSE)
  
df_sitename_corr_long <- 
  df_sitename_corr %>% 
    pivot_longer(-term)

# correlation of phase 2 artifacts
df_sitename_corr_p2 <- 
  df_sitename %>%
  dplyr::filter(SPstage.Stage == 2) %>%
  dplyr::select(-sitename, -SPstage.Stage, -SPstage.Raw_material) %>% 
  correlate() %>% 
  shave() 

p2_corr_plot <- rplot(df_sitename_corr_p2, 
                      print_cor = TRUE,
                      legend = FALSE)
  
df_sitename_corr_p2_long <- 
  df_sitename_corr_p2 %>% 
    pivot_longer(-term)

# correlation of phase 3 artifacts
df_sitename_corr_p3 <- 
  df_sitename %>%
  dplyr::filter(SPstage.Stage == 3) %>%
  dplyr::select(-sitename, -SPstage.Stage, -SPstage.Raw_material) %>% 
  correlate() %>% 
  shave() 

p3_corr_plot <-  
  rplot(df_sitename_corr_p3, 
        print_cor = TRUE) +
   theme(legend.position = c(0.9, 0.9),
         legend.key.size = unit(0.3, 'cm'), #change legend key size
        legend.key.height = unit(0.3, 'cm'), #change legend key height
        legend.key.width = unit(0.3, 'cm'), #change legend key width
        legend.title = element_text(size=6), #change legend title font size
        legend.text = element_text(size=8))
  

df_sitename_corr_p3_long <- 
  df_sitename_corr_p3 %>% 
    pivot_longer(-term)


# compare p2 and p3 correlations
compare_p2_and_p3_correlations_plot <- 
list(`phase 2` = df_sitename_corr_p2_long,
     `phase 3` = df_sitename_corr_p3_long) %>% 
  bind_rows(.id = "phase") %>% 
  ggplot() +
  aes(phase,
      value) +
  geom_boxplot() +
  ggbeeswarm::geom_quasirandom(size = 2,
                               alpha = 0.3) +
  theme_minimal() +
  labs(y = "Correlation coefficient") +
theme(axis.title.y = element_text(size = 13)) +
  # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value_cor, colour = "red") +
  theme_bw()

plot_grid(plot_grid(
          plot_grid(
                    all_corr_plot,        
                    p2_corr_plot, 
                    p3_corr_plot,
                    ncol = 1,
                    labels = c("A", "B", "C")),
          compare_p2_and_p3_correlations_plot,
          ncol = 2,
          labels = c("", "D"),
          rel_heights = c(1, 2.5)))


# ggsave(here::here("analysis/figures/fig-corr-analysis.png"),
#        width = 4,
#        height = 3,
#        units = "in")

```

One limitation of this aggregation of stemmed points into chronological phases is that the sample consists of a relatively large number of assemblages with only 1-2 stemmed points. These isolated finds are ambiguous with respect to local traditions of artifact making, so to further investigate temporal change, we focus only on the four assemblages that have more than five stemmed points (@fig-plot-cor-four-assemblage). We assume these four assemblages are more likely to represent a consistent, recurring way of making stemmed points than isolated finds, and thus more relevant for comparing modes of cultural transmission of artifact making. The four assemblages include three from Suyanggae (SYG) and one from Yongsandong (YS). @fig-plot-cor-four-assemblage shows that at this finer scale of resolution the picture is complex. Phase 2 shows both highly correlated attributes, from SYG1_2, and relatively uncorrelated attributes, from SYG6_2. The two assemblages from Phase 3 show similarly highly correlated attributes, with the median right around our threshold value of `r threshold_value_cor`; however, the spread of correlations is high, suggesting a mixture of transmission biases.

```{r}
#| label: fig-plot-cor-four-assemblage
#| fig-cap: Correlation for assemblages with more than 5 stemmed points. Among the four assemblages, SYG1_2 and SYG6_2 are from Phase 2 of the Korean Late Paleolithic chronology and SYG1_3 and YS_3 are from Phase 3. The grey points represent correlation between two attributes.
#| fig-width:   4.5
#| fig-height:  3.5

#### plot cors by site with number of artifacts showing >5

cor_by_site_df_label_more_than_5 <-
  df_sitename %>%
  unite(col = "site_phase",
        c(sitename,
          SPstage.Stage),
        sep = "_") %>%
  dplyr::select(-SPstage.Raw_material) %>%
  dplyr::group_by(site_phase) %>%
  add_tally() %>%
  dplyr::filter( n > 5) %>%
  mutate(label = as.factor(paste0(site_phase,' (N = ', n, ")"))) %>%
  nest(-site_phase) %>%
  mutate(corrr = purrr::map(data, ~correlate(.x) %>%  
                                   shave() %>% 
                                  pivot_longer(-term))) %>% 
  unnest(corrr) %>% 
  filter()

#better arrangement for x axis for the plot
level_order <- c('SYG1_2', 'SYG6_2', 'SYG1_3', 'YS_3')

  ggplot(cor_by_site_df_label_more_than_5) +
  aes(x=factor(site_phase, level=level_order), y=value) +
  geom_boxplot() +
  ggbeeswarm::geom_quasirandom(size = 2,
                               alpha = 0.3) +
  theme_minimal() +
  labs(y = "Correlation coefficient",
       x = "Assemblage") +
theme(axis.title.y = element_text(size = 7.5)) +
  # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value_cor, colour = "red") +
  theme_bw()
  
# ggsave(here::here("analysis/figures/fig-plot-cor-four-assemblage.png"),
#        width = 4,
#        height = 3,
#        units = "in")

```

### Correlations and raw materials

To examine the impact of raw materials on the shape of stemmed points, we computed the correlations of attributes among raw material groups. We excluded raw materials that were used for less than three points. @fig-corr-raw-ass shows that the most abundant raw materials have relatively high correlation coefficients. The stemmed points made from quartzite and porphyry have the highest correlation coefficients with relatively narrow distributions. Acidic volcanic rocks are one of the more highly correlated materials, with an outlier group with much lower correlations. Similarly, the correlation of shale stemmed points is also divided into two groups. Rhyolite stemmed points have a wide distribution of correlations, and some of the attributes are even negatively correlated. Tuff stemmed points have a wide distribution with a high median value.

```{r}
#| label: fig-corr-raw-ass
#| fig-cap: Correlation for raw materials that were used for making more than one stemmed points. The grey points represent correlation between two attributes.

#| fig-width:7
#| fig-height:5

# correlation by raw material
df_sitename_corr_raw_material <- 
  df_sitename %>%
  group_by(SPstage.Raw_material) %>% 
  filter(n() >= 3) %>% 
  dplyr::select(-sitename, 
                -SPstage.Stage) %>% 
  nest(-SPstage.Raw_material) %>% 
  mutate(corrr = purrr::map(data, ~correlate(.x) %>%  
                                   shave() %>% 
                                  pivot_longer(-term))) %>% 
  unnest(corrr) %>% 
  filter()

# correlations_by_raw_material <- 
  ggplot(df_sitename_corr_raw_material) +
  aes(SPstage.Raw_material,
      value) +
  geom_boxplot() +
  ggbeeswarm::geom_quasirandom(size = 2,
                               alpha = 0.3) +
  theme_minimal() +
  labs(y = "Correlation coefficient",
       x = "Raw material") +
theme(axis.title.y = element_text(size = 4)) +
  # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value_cor, colour = "red") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2))+
  theme_bw()
  
# ggsave(here::here("analysis/figures/fig-corr-raw-ass.png"),
#        width = 4,
#        height = 3,
#        units = "in")
```

### Coefficient of variation

```{r}
#| label: prepare-for-cv-calcs

# Coefficient of variation (CV): the ratio of the standard deviation divided by mean

# cv <- function(x, ... ) sd(x, ...) / mean(x, ...) * 100

# use this one that is optimized for small samples, returns value 0-1, not %. 
# We multiply 100 (%) later, altogether with confident interval.

mccv <- function(x, ... ) sd(x, ...) / mean(x, ...) * (1 + 1/(4*length(x)))

# BM: this is the cvCI function from https://github.com/stamats/MKmisc, I 
# removed all the non-sharma methods and replaced CV() with mccv() above

sharma_cvCI <- function(x, 
                 conf.level = 0.95, 
                 method = "sharma", 
                 na.rm = FALSE){
    stopifnot(is.numeric(x))

    if(length(conf.level) != 1)
        stop("'conf.level' has to be of length 1 (confidence level)")
    if(conf.level < 0.5 | conf.level > 1)
        stop("'conf.level' has to be in [0.5, 1]")

    alpha <- 1 - conf.level
    zquant <- qnorm(1-alpha/2)
    cv <- mccv(x = x, na.rm = na.rm)
    Infos <- NULL
    if(na.rm) x <- x[!is.na(x)]
    n <- length(x)

     # Sharma and Krishna 1994
      CI.lower <- 1/(1/cv + zquant/sqrt(n))
      CI.upper <- 1/(1/cv - zquant/sqrt(n))
      METH <- "Sharma and Krishna (1994) confidence interval"
    
    CI <- matrix(c(CI.lower, CI.upper), nrow = 1)
    rownames(CI) <- "CV"
    colnames(CI) <- c(paste(alpha/2*100, "%"), paste((1-alpha/2)*100, "%"))
    attr(CI, "conf.level") <- conf.level
    names(cv) <- "CV"

    return(structure(list("estimate" = cv, "conf.int" = CI, "Infos" = Infos,
                          "method" = METH),
                     class = "confint"))
}
```

```{r}

# we've got DF a data frame with cols as variables
# rows and specimens, and values as dimensions
# need to add a column of site ID

DFCV <- map_dbl(DF, mccv)


# GP's test for comparing CV vs corrected CV
# mock_test <-
#   readr::read_csv(here::here("analysis/data/raw_data/mock_test.csv"))
# mock_test_cv <-map_dbl(mock_test, cv)
# mock_test_mccv <- map_dbl(mock_test, mccv)

#Same as map but better view for summary
cv_all <- map_df(DF, mccv)
#arrange the data properly
cv_data_all <- gather(cv_all)

# to install MKmisc
## Install package BiocManager
# install.packages("BiocManager")
## Use BiocManager to install limma
# BiocManager::install("limma")
# install.packages("MKmisc")

library(MKmisc)
library(purrr)
# CV value
sharma_cv <- function(x,...) sharma_cvCI(x, conf.level = 0.95, method = "sharma", na.rm = FALSE)$estimate * 100

#CV sharma interval values
sharma_int_low <- function(x,...) sharma_cvCI(x, conf.level = 0.95, method = "sharma", na.rm = FALSE)$conf.int[1] * 100

sharma_int_high <- function(x,...) sharma_cvCI(x, conf.level = 0.95, method = "sharma", na.rm = FALSE)$conf.int[2] * 100

all_cv_sharma <- map_dbl(DF, sharma_cv)
all_low_sharma <- map_dbl(DF, sharma_int_low)
all_high_sharma <- map_dbl(DF, sharma_int_high)

#create data frame
cv_data_sharma <- data.frame(all_cv_sharma, all_low_sharma, all_high_sharma)

#add column name
library(tibble)
cv_data_sharma_named <- rownames_to_column(cv_data_sharma, var = "attribute")

# for in-text numbers
max_cv <- round(max(cv_data_sharma_named$all_cv_sharma), 1)
min_cv <- round(min(cv_data_sharma_named$all_cv_sharma), 1)

```

```{r}
#| label: fig-plot-attributes
# Box plot for each attribute
# mutate data to make plot with ggplot
data_box <- gather(DF)
# make box plot for each attributes
plot_raw_measurements_for_attributes <- 
ggplot(data_box,
       aes(key, value)) +
  geom_boxplot() +
  geom_beeswarm(alpha = 0.3,
                size = 0.8,
                cex = 0.7) +
  ylab("Length (cm)") +
  xlab("") +
  theme_bw()
```

In addition to correlation coefficients of point attributes, we measured coefficients of variation (CVs) to quantify variability in individual attributes. @fig-plot-cv-all-attributes shows that CV values for all attributes are distributed from `r min_cv`% to `r max_cv`%. Compared to the CVs of Great Basin projectile points [@eerkens2001techniques], the average CV for Korean artifacts is higher. The CVs for body length (BL) and maximum length (ML) have the lowest values. The low CV and narrow confidence intervals for maximum length indicate that this dimension is highly standardized relative to the others. Tang and stem related attributes (e.g. SL, SW, TL, TW) are less standardized with higher CV values and wider confidence intervals than other attributes. Overall, with all but one attribute having CV values above our threshold value, our results suggest that the transmission of stemmed points was mostly influenced by guided variation.

```{r}
#| label: fig-plot-cv-all-attributes
#| fig-cap: The points and numbers represent the CV values for each attribute measured on the stemmed points. The vertical lines indicate the 95% confidence intervals for the CV values, which were computed using Sharma and Krishna's method. The red line at CV = 25 indicates our approximate threshold to distinguish between guided variation (>25) from indirect bias (<25). 

#| fig-width:7
#| fig-height:4

ggplot(cv_data_sharma_named,
       aes(attribute,
           all_cv_sharma)) +        # ggplot2 plot with confidence intervals
  geom_point() +
  geom_errorbar(aes(ymin = all_low_sharma, 
                    ymax = all_high_sharma), 
                width = 0.2) +
  ylab("Coefficient of Variation") +
  xlab("Artifact measurement") +
  geom_text(aes(label = round(all_cv_sharma,1)), 
            col="blue", 
            hjust = -0.3, 
            size = 3) +
  # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value, colour = "red") +
  theme_bw()

# ggsave(here::here("analysis/figures/fig-plot-cv-all-attributes.png"),
#        width = 4.3,
#        height = 3,
#        units = "in")

```

In @fig-plot-cv-over-time, CV values for stemmed points are grouped into three chronological phases to analyze temporal patterns in cultural transmission. We excluded stemmed points from Phase 1 due to the limited number of artifacts dating to this time. @fig-plot-cv-over-time shows that the temporal trend in CV values of artifact attributes is complicated. Half of the attributes are below our threshold value of `r threshold_value`, and half are above for both phases. Only body length (BL) crosses the threshold value, changing from \<`r threshold_value` to \>`r threshold_value` over time, suggesting a shift from indirect bias to guided variation. For those attributes where the CV is \<`r threshold_value`, the trend is decreasing CV values from Phase 2 to Phase 3 for maximum width (MW) and tang width (TW), indicating increasing influence of indirect bias for these attributes. For stem length (SL), stem width (SW) and tang length (TL), CV values remain above `r threshold_value`, and show a slight trend to increase over time, suggesting increased influence of guided variation for these stem and tang attributes.

```{r}
#| label: fig-plot-cv-over-time
#| fig-cap: CV values for the second and third chronological phases in the Korean Late Paleolithic period. The points represent CV values for each attribute. The vertical lines indicate the 95% confidence intervals for the CV values, which were computed using Sharma and Krishna's method. The red line at CV = 25 indicates our approximate threshold to distinguish between guided variation (>25) from indirect bias (<25).
#| fig-width:   4.5
#| fig-height:  4

#-- temporal patterns ----------------------------------------------------------------
# Make a table of CVs for all variable grouped by stage, according to
# stemmed point chronology
# Exclude the first phase that has only two artifacts

cv_by_stage_df  <-
  df_sitename %>%
  dplyr::select(-sitename,
         -SPstage.Raw_material) %>%
  group_by(SPstage.Stage) %>%
  add_tally() %>%
  dplyr::filter(n >= 5) %>%
  dplyr::select(-n) %>%
  pivot_longer(-SPstage.Stage,
               names_to = "variable",
               values_to = "value") %>%
  group_by(SPstage.Stage, variable) %>%
  dplyr::summarise(cv_by_site =   sharma_cv(value),
            cv_low_sharma =  sharma_int_low(value),
            cv_high_sharma = sharma_int_high(value))

# facet plot for two phases
cv_by_stage_df %>%
  ggplot(aes(x = factor(SPstage.Stage),
             y = cv_by_site)) +
  geom_point() +
  geom_errorbar(aes(ymin = cv_low_sharma,
                    ymax = cv_high_sharma),
                width = 0.2) +
  xlab("Phase") +
  ylab("Coefficient of Variation") +
    # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value, colour = "red") +
  facet_wrap( ~ variable, scales = "free_y") +
  theme_bw()

# ggsave(here::here("analysis/figures/fig-plot-cv-over-time.png"),
#        width = 4.3,
#        height = 3,
#        units = "in")


```

We further analyzed temporal change by looking at specific assemblages in each chronological phase. Following previous studies [@bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @mesoudi2008cultural; @garvey2018current], we focused on CV values for body length (BL), maximum length (ML), mid width (MW), and tang width (TW) for assemblages that have five or more stemmed points. @fig-plot-cv-four-assemblage shows that CV values for the four assemblages are mostly slightly below `r threshold_value`, with no temporal trend apparent between Phase 2 and Phase 3. Overall we see only subtle changes in CV values from Phase 2 to Phase 3 in @fig-plot-cv-four-assemblage. Among the assemblages, SYG1_2 has higher CV values as well as the widest ranges of confidence intervals. This is unexpected because SYG1_2 has a strong correlation between attributes (@fig-plot-cor-four-assemblage). Perhaps it could be related to its small sample size, relative to the other assemblages compared here. The larger assemblages in @fig-plot-cv-four-assemblage indicate guided variation, while the smaller assemblages that dominate @fig-plot-cv-over-time suggest indirect bias. Perhaps smaller assemblages represented a social context of higher fidelity copying because the cost of failure was greater due to low social insurance because of low population network sizes and densities [@fitzhugh2011modeling]. Another interpretation is that these results suggest that the complex temporal trends in @fig-plot-cv-over-time might be best interpreted as noise in an overall signal of guided variation, rather than substantial changes in the type of bias dominating cultural transmission.

```{r}
#| label: fig-plot-cv-four-assemblage
#| fig-cap: CV values of four attributes from assemblages with more than 5 stemmed points. Among the four assemblages, SYG1_2 and SYG6_2 are from Phase 2 of the Korean Late Paleolithic chronology and SYG1_3 and YS_3 are from Phase 3. The points represent CV values for each attribute. The vertical lines indicate the confidence intervals. The red line at CV = 25 indicates our approximate threshold to distinguish between guided variation (>25) from indirect bias (<25).
#| fig-width:   4.5
#| fig-height:  4

#### plot CVs by site with number of artifacts showing >5

cv_by_site_df_label_more_than_5 <-
  df_sitename %>%
  unite(col = "site_phase",
        c(sitename,
          SPstage.Stage),
        sep = "_") %>%
  dplyr::select(-SPstage.Raw_material) %>%
  dplyr::group_by(site_phase) %>%
  add_tally() %>%
  dplyr::filter( n > 5) %>%
  mutate(label = as.factor(paste0(site_phase,' (N = ', n, ")"))) %>%
  ungroup() %>%
  dplyr::select(-n, -site_phase) %>%
  pivot_longer(-label,
               names_to = "variable",
               values_to = "value") %>%
  dplyr::group_by(label, variable) %>%
  dplyr::summarise(cv_by_site =   sharma_cv(value),
            cv_low_sharma =  sharma_int_low(value),
            cv_high_sharma = sharma_int_high(value)) %>%
  dplyr::filter(variable %in% c("ML", "BL","MW", "TW"))

cv_by_site_df_label_more_than_5 %>%
  ggplot(aes(x = factor(variable),
             y = cv_by_site)) +
  geom_point() +
  geom_errorbar(aes(ymin = cv_low_sharma,
                    ymax = cv_high_sharma), width = 0.2) +
    # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value, colour = "red") +
  xlab("Attribute") +
  ylab("Coefficient of Variation") +
  facet_wrap( ~ label, scales = "free_y") +
  coord_cartesian(ylim = c(15,60)) +
  theme_bw()

# ggsave(here::here("analysis/figures/fig-plot-cv-four-assemblage.png"),
#        width = 4,
#        height = 3,
#        units = "in")



```

### Variation Between Raw Materials

We examined the relationship between CV values and raw materials to test the hypothesis that the shape variability of stemmed points was dependent on raw materials. We excluded raw materials that were used for less than three points. @fig-plot-cv-by-raw-material shows that quartzite, the raw material for stemmed points at Sachang, has the highest CV values, and also has wide confidence intervals. Other raw materials are generally low, right around our threshold value, and stable in variation across the attributes.

```{r}
#| label: fig-plot-cv-by-raw-material
#| fig-cap: CV values for raw materials that were used for making more than three stemmed points. The points represent CV values for each attribute. The vertical lines indicate the confidence intervals. The red line at CV = 25 indicates our approximate threshold to distinguish between guided variation (>25) from indirect bias (<25).
#| fig-width:   8.5
#| fig-height:  4

# CV by raw materials
### Make a table of CVs for all variable grouped by raw materials
cv_by_raw_materials <-
  df_full_sitename %>%
  dplyr::select(-SPstage.Stage, -lat_dd, -long_dd, -sitename, -full_sitename) %>%
  group_by(SPstage.Raw_material) %>%
  add_tally() %>%
  dplyr::filter( n >= 3) %>%
  dplyr::select(-n) %>%
  pivot_longer(-SPstage.Raw_material,
               names_to = "variable",
               values_to = "value") %>%
  group_by(SPstage.Raw_material, variable) %>%
  dplyr::summarise(cv_by_materials =   sharma_cv(value),
            cv_low_sharma =  sharma_int_low(value),
            cv_high_sharma = sharma_int_high(value))

######CV for per raw materials (n=X) with the full site name : label
cv_by_raw_materials_df_label <-
  df_sitename %>%
  group_by(SPstage.Raw_material) %>%
  add_tally() %>%
  dplyr::filter( n > 1) %>%
  mutate(label = as.factor(paste0(SPstage.Raw_material,' (N = ', n, ")"))) %>%
  dplyr::select(-n) %>%
  nest(-SPstage.Raw_material, -label) %>%
  mutate(cv_by_site = purrr::map(data, ~map_df(.x, mccv))) %>%
  dplyr::select (-cv_by_site)

######add label to main dataframe
cv_plot_raw_materials_label <- cv_by_raw_materials %>%
  left_join (cv_by_raw_materials_df_label) %>%
  dplyr::select (- data,-SPstage.Raw_material)

###### facet plot
cv_plot_raw_materials_label %>%
  ggplot(aes(x = variable, y = cv_by_materials)) +
  geom_point() +
  geom_errorbar(aes(ymin = cv_low_sharma,
                    ymax = cv_high_sharma), width = .2) +
    # draw a line to show our threshold value
  geom_hline(yintercept = 25, colour = "red") +
  xlab("Raw Material") +
  ylab("Coefficient of Variation") +
  facet_wrap( ~ label, scales = "free_y") +
  coord_cartesian(ylim = c(0,250)) +
  theme_bw() 



# ggsave(here::here("analysis/figures/fig-plot-cv-by-raw-material.png"),
#        width = 4.3,
#        height = 3,
#        units = "in")

```

## Discussion

To investigate the social contexts of technological transitions represented by the emergence of stemmed points during the Korean Late Paleolithic, we drew on concepts of cultural transmission from the broader framework of cultural evolutionary theory. We asked three questions to examine the cultural transmission process over time: what was the dominant mode of cultural transmission for technological innovation in the Korean Late Paleolithic? Do the modes of cultural transmission vary over time? And do the modes of cultural transmission vary over space? We focused on two transmission biases: guided variation (socially isolated groups making stemmed points through trial and error) and indirect bias (socially connected groups whose knowledge of stemmed points derived from copying others). Following @bettinger1999point, we used `r threshold_value_cor` as an approximate threshold value for interpreting correlation coefficients to evaluate which of the two transmission biases was dominant. Correlation coefficients below `r threshold_value_cor` are indicative of guided variation and higher values indicate indirect bias. Since there are no previously established criteria for CV, we derived `r threshold_value`% from previous work to use as our threshold of the CV value to decide between these two types of transmission biases, based on prior work on Great Basin Projectiles [@eerkens2001techniques]. If the CV value is lower than `r threshold_value`, we interpret this as indicating indirect bias while values higher than `r threshold_value` are interpreted as guided variation.

Our correlation analyses found that the correlation coefficients of stemmed points are mostly positive and mostly at or under `r threshold_value_cor`, showing the possibility of guided variation as their main transmission bias. Some correlations such as body length and maximum length have strong relationships while other correlations such as tang length and body length are much weaker. Given these results, transmission of the artifact shape as a package seems unlikely. The correlation coefficients increase from chronological Phases 2 to 3 (Panel D of @fig-corr-analysis), but when we look at individual assemblages, the pattern is not consistent and the values vary depending on the assemblage (@fig-plot-cor-four-assemblage). When all artifacts are considered together, CV values for all stemmed point attributes are mostly over `r threshold_value`, except for maximum length, which is just below. However, further analysis by site and raw material shows more ambiguous patterns, with CV values close to or below the threshold value. Change in CV values over time in the Korean Late Paleolithic period is complex, with no clear directional changes (@fig-plot-cv-over-time). Comparing chronological Phase 2 and 3, we found that there are only minor differences between the two phases. Applying the Modified Signed-Likelihood Ratio Test (MSLR) to test for the equality of CVs [@smallwood2022using; @krishnamoorthy2014improved], we found no statistically significant changes in the CV values of any attributes (@tbl-cv-over-time) between the two phases. In exploring individual assemblages that contain multiple stemmed points, we observed minimal changes in CV values over time (@fig-plot-cv-four-assemblage).

```{r}
#| label: tbl-cv-over-time
#| tbl-cap: "Summary of significance tests for CV values between the two chronological phases"

####### significant test between the two phases ######
library(cvequality)

# created nested tibble, nest by variable
df_sitename_nested <-
  df_sitename %>%
  dplyr::select(-sitename, -SPstage.Raw_material) %>%
  group_by(SPstage.Stage) %>%
  add_tally() %>%
  dplyr::filter(SPstage.Stage > 1) %>%
  dplyr::select(-n) %>%
  pivot_longer(-SPstage.Stage,
               names_to = "variable",
               values_to = "value") %>%
  ungroup() %>%
  group_by(variable) %>%
  nest()

# apply mslr test to each variable (row with a tibble)
# Krishnamoorthy and Lee’s (2014) modified signed-likelihood ratio test
# this is a table we can show in the text
table_mslr_test_results_for_phase_differences <-
  df_sitename_nested %>%
  mutate(mslr_result = map_df(data, ~mslr_test(nr = 1e4,
                                               .$value,
                                               .$SPstage.Stage))) %>%
  unnest(mslr_result) %>%
  dplyr::select(-data) %>% 
  # round numeric columns to 3 decimal places
  mutate(across(where(is.numeric), round, 3)) %>% 
  arrange(desc(p_value))

names(table_mslr_test_results_for_phase_differences) <- 
  c("Variable", "MSLR statistic", "p value")

knitr::kable(table_mslr_test_results_for_phase_differences,
             digits = 3)

```

In exploring variation between sites, as a proxy for spatial variation, we found no readily interpretable pattern of variation in both correlation coefficients (@fig-plot-cor-four-assemblage) and CV values (@fig-plot-cv-four-assemblage) between assemblages with more than five stemmed points. We found that correlation coefficients and CV values are distributed differently in each assemblage. While SYG1_2 and SYG1_3 are from the same site, they belong to different chronological periods, and their correlation decreases over time. It is likely that the correlation or overall shape may be more dependent on individual knappers. We also found that some attributes such as maximum width (MW) and maximum length (ML) have stronger correlation, while the others including stem length (SL) and body length (BL) have lower or even negative correlation. Based on these findings, we propose that certain attributes were more carefully transmitted than others. Artifact shape does not appear to have been transmitted as a package, but as a flexible set of attributes that can vary with respect to each other. We observed that CV values of body length (BL), maximum length (ML), mid width (MW), and tang width (TW) are generally lower than tang length (TL), stem length (SL), and stem width (SW) (cf. @fig-plot-cv-all-attributes).

According to our model, attributes with lower CV values were transmitted in a social context dominated by indirect bias, whereas attributes with high CV values were likely influenced more by specific local manufacturing and maintenance situations. We assume that the lower CV values imply that those attributes, BL, ML, MW and TW, were closely associated with the generic projectile function of the tool, Keeping variability low for those attributes would have standardized the shape to ensure predictable performance. For example, body length is related to penetration, durability, hardness, and rejuvenation of a projectile point and tang width is connected to wound damage, penetration, durability and hardness [@odell1986experiments; @shea2001experimental; @cheshier2006projectile; @yaroshevich2016projectile; @bebber2017developing; @wood2018wound]. This can be contrasted with tang length, stem length, and stem width, which are away from the point of impact at the end of the artifact. Our results show these were allowed to vary more freely between specimens, perhaps to be able to accommodate shafts of different types of wood with varying properties of strength, flexibility, and weight.

The most striking differences in both correlation coefficients and CV values are in comparisons of points grouped by raw materials (@fig-corr-raw-ass, @fig-plot-cv-by-raw-material). Raw materials likely had a substantial impact on stemmed points' shape variance. We expected that stemmed points with higher correlation coefficients would also have lower CV values, but the results do not exactly match our expectations because of how influential raw materials are on CV values. For example, artifacts made from acidic quartzite have the highest correlations, but their CV values are also much higher with wider confidence intervals than all other raw materials. These complex results might be related to the relatively unpredictable knapping quality of quartzite. Large grains within quartzite can redirect knapping forces in unexpected directions, resulting in unintended flake removals. This makes it harder for the knapper to repeatedly produce the same size and shape end product. Variation in raw material nodule size may also contribute to this pattern, for example quartzite nodules may have been found in a much wider range of sizes than nodules of other raw materials. We could not strongly argue this here due to the small sample size of quartzite to generalize this pattern, but this hints at the possibility that the physical properties of the stone artifact raw materials were a key mechanism in determining shape and size variability. Further analysis of raw material properties and availability is needed to make robust conclusions about their influence here.


## Conclusion

In this research we investigated the social contexts of technological innovation in the Korean Late Paleolithic. Following previous studies that applied cultural transmission to the introduction of new technologies [@bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @garvey2018current], we examined two transmission biases, guided variation (trial and error) and indirect bias (copying a model). We proposed two scenarios for explaining the introduction of new technology: socially isolated groups that developed stemmed points through trial and error (guided variation) or socially connected groups whose knowledge of stemmed points derived from copying others that they regularly came into contact with (indirect bias). We asked three questions: what is the dominant mode of cultural transmission for technological innovation in the Korean Late Paleolithic? Do the modes of cultural transmission vary over time? And do the modes of cultural transmission vary over space?

We conclude that the dominant mode of cultural transmission for the earliest stemmed points was mostly likely guided variation (trial and error). This is indicated by mostly low correlation coefficients of less than `r threshold_value_cor` and relatively high CV values of around and above `r threshold_value`. A social context that favored trial and error for artifact making is most consistent with Seong's *in situ* model for the appearance of stemmed points in Korea. This model proposes that people developed stemmed points by experimenting with existing elongated flakes and blades. Our results support experimentation and trial and error as important processes in the cultural transmission of this artifact technology.

The correlation coefficients suggest a change in the dominant bias of cultural transmission over time, with values around `r threshold_value_cor` in chronological Phase 3, after 25 ka. It is in the same range as the correlation coefficients that Bettinger and Eerkens interpreted as indirect bias. We also found a slight decrease in CV values for the four attributes. Those results suggest a shift away from trial and error and towards greater reliance on copying a model in the social context of tool-making skills transmission. Drawing on evolutionary ecological theory, we might speculate that the cooler conditions of the Last Glacial Maximum promoted greater integration of social networks to buffer risks of resource failure [cf. @fitzhugh2001risk]. With more frequent contacts and connections with members of social networks, there may have been more opportunities to learn point-making directly from socially successful individuals.

In comparing assemblages with more than five stemmed points, we found complex variation in CV values that may suggest mixtures of biases in the transmission of tool-making techniques. We did not find strong support for distinctive, exclusive cultural transmission biases in tool-making in different assemblages. Correlation coefficient values across the assemblages confirm the overall chronological trend indicating indirect bias in Phase 3. Raw material choice appears to be important in driving this trend, with acid volcanic rocks and porphyry becoming more abundant in Phase 3, and dominating assemblages at Yonsangdong that date to this period. One possibility is that these more easily manageable raw materials were part of an adaptive shift during the Last Glacial Maximum, where perhaps the cooler climate favored an expanded range for searching for raw materials, leading to a higher diversity. Similarly, changes in occupation and mobility patterns may have resulted in more frequent contacts and connections with members of social networks [@park2022did]. This may have provided more opportunities to learn point-making directly from socially successful individuals, and increased the contribution of indirect bias during cultural transmission during Phase 3.

We concede that our work is rather speculative and provides only a limited explanation of the social contexts surrounding the spread of stemmed points. Although social learning and migration or drift models requires approximate estimates for population and generation turnover required to transmit knowledge of new technology, we were unable to employ this approach due to the large number of assumptions required to cover a 25,000-year time span. In her simulation study, Garvey was able to derive the population at a particular site based on the number of rooms [@garvey2018current], but our research sites lacked sufficient information to utilize this method. Moreover, we recognize that we did not account for the possibility of the shape of stone artifacts being modified through reuse and resharpening, which can result in the remaining shape of stemmed points being different from their original form through inherited technology (i.e. the Frison Effect) [@dibble1995middle; @jelinek1976form; @frison1968functional]. Furthermore, we only considered two types of biases, as our primary goal was to understand the general trajectory of technological transition, and we had limited empirical evidence to explore a multiplicity of conjectural scenarios. In future research, we plan to focus more closely on individual assemblages and site occupation to gain a better understanding of the population responsible for creating and using stemmed points. By so doing, we anticipate achieving a more exhaustive understanding of the morphology of stemmed points and the mechanisms behind their transmission.

# Acknowledgements

We would like to thank Yongjoon Chang, Seonsook Park, Jaeyoung Kim, Soonmi Lee, Taeyoung Kim, and the staff in Korean national museums, and Sangtaek Lim, Chuntaek Seong, Sangmin Cha, Sooa Kim, Gigil Lee, Myeongjin Choi, and Chanho Park in local archaeological institutions and university museums in Korea for permitting access to their collection used in this study and assisting our trip to Korea. We thank the Quaternary Research Center, Department of Anthropology and Center for Statistics and the Social Sciences at the University of Washington for supporting our research trip. We also appreciate Ben Fitzhugh and Peter Lape for their insightful comments that have greatly improved this manuscript.

# CRediT authorship contribution statement

Gayoung Park: Conceptualization, Software, Validation, Formal analysis, Methodology, Resources, Data curation, Writing - original draft, Writing - Review & Editing, Visualization, Project administration.

Ben Marwick: Software, Validation, Formal analysis, Investigation, Writing - Review & Editing, Visualization, Supervision

\newpage

# References {.unnumbered}

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```

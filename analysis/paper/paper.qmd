---
title: "Cultural Transmission and Technological Transitions during the Late Paleolithic in Korea"
author:
  - Gayoung Park:
      institute: uw
      correspondence: "yes"
      email: gayoungp@uw.edu
  - Ben Marwick:
      institute: uw
institute:
  - uw:
      name: Department of Anthropology, University of Washington
      address: Seattle, WA, USA
format: 
  docx:
    reference-doc: "../templates/template.docx" # Insert path for the DOCX file
execute:
  echo: false
  warning: false
  message: false
  comment: "#>"
  fig-path: "../figures/"
  fig-dpi: 600
  cache: false
editor: visual
date: now
date-format: long
title-block-published: "Last updated" 
filters:
  - ../templates/scholarly-metadata.lua
  - ../templates/author-info-blocks.lua
  - ../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style

abstract: |
  The onset of the Late Paleolithic period in Korea, represented by the appearance of stemmed points and blades, was a key event in the dispersal of modern humans in Northeast Asia. Previous studies have mainly focussed on possible origin locations of these new technologies. The specific cultural processes of the appearance stemmed points and blades has rarely been considered. We investigate the cultural processes by applying a cultural transmission framework to investigate the social contexts of the emergence of these new technologies. Our main question is: what was the dominant mode of cultural transmission during this time of technological innovation in the Korean Late Paleolithic? Following Bettinger and Eerkens [-@bettinger1999point], we evaluated models of guided variation and indirect bias using data from Korean assemblages containing stemmed points. To evaluate these models and understand the transmission processes, we computed coefficients of variation (CV), and Principal Component Analysis (PCA). We found that information about the new technology was likely transmitted via selective combinations of guided variation and indirect bias. Some attributes including length and width were transmitted through indirect bias, while other attributes appear to have been more due to guided variation. Our results suggest that individuals or groups learned some part of the technology of stemmed points by copying a model from another another individual or group, and then modified the shape according to their specific circumstances.
  
keywords: |
  Stemmed points; Korean Paleolithic; Cultural Transmission; Learning process, Transmission Biases
---

# Introduction {.unnumbered}

The application of evolutionary theory to archaeological research has been productive for the investigation of technological transitions and related human behaviors in the remote past [@dunnell1980evolutionary; @lipo1997population; @bettinger1997rediscovering; @bettinger1999point; @mesoudi2008cultural]. For example, archaeologists have used evolutionary theory and methods to study human behavioral ecology, cultural transmission, artifact phylogenetics, and niche construction in the past [@riede2010isn; @o2017dual; @garvey2018current]. In this paper we used cultural transmission theory to investigate technological transitions during the Korean Late Paleolithic. The primary technological innovation is during this time was the appearance of new tools such as stemmed points and blades. The appearance of these new lithic technologies may represent the first arrival of modern humans in this region, and so they may also represent a key event related to modern human dispersal throughout East Asia [@seong2009emergence]. Previous studies on the origin of stemmed points have mainly focused on their possible origin locations, connecting Korea with global patterns of modern human dispersal. However, questions about the specific cultural processes and social contexts of this technological change in Korea remain largely unanswered [@seong2008tanged; @bae2010origin; @bae2017origin]. In this research, we apply a cultural transmission framework to investigate the social contexts of the emergence of new technologies in the Korean Late Paleolithic. Our main question is: what was the dominant mode of cultural transmission for technological innovation in the Korean Late Paleolithic? Additionally we ask: Do the modes of cultural transmission vary over time and space? We consider three possible modes of cultural transmission: guided variation (trial and error), indirect bias (copying others), or a combination of the two. Our results have implications for determining if these new technologies were introduced from outside of the Korean Peninsula, or if they were locally, independently developed.

# The Late Paleolithic of the Korean Peninsula {.unnumbered}

The onset of the Late Paleolithic period in Korea is marked by the appearance of stemmed points around 40-35 ka. The stemmed point is a projectile point made out of an elongated flake or blade with slight retouch on the proximal end to shape an acute tip, and on the distal end to make a stem, which connects to a shaft. The stemmed point was the first composite tool type appearing on the Korean Peninsula, and represents new hunting strategies there, as well as other adjacent regions where it appeared later [@seong2008tanged; @lee2019were]. Stemmed points, combined with blade technology, multi-stage production sequences, and evidence of being resharpened and reused, are important aspects of the Late Paleolithic technological innovations in Korea because these features are rarely seen in earlier periods [@chang2013human; @bamforth2009projectile; @seong2015diversity]. Currently the earliest stemmed points in Northeast Asia are from Yongho-doing site in Korea dated to 38.5ka and made on elongate flakes [@seong2009emergence; @seong2015diversity; @bae2017origin]. After their first appearance in Korea, the stemmed points spread to the Japanese archipelago [@chang2013human].

Previous studies of technological transitions during the Late Paleolithic in Korea have mainly focused on the possible origin locations of stemmed points, along with the issue of the timing and routes of modern human dispersal in eastern Asia. The debate about the origin of stemmed points can be summarized into two competing models: *in situ* evolution [@seong2009emergence] and heterogenic migration [@bae2010origin]. The *in situ* model claims that stemmed points and other Late Paleolithic assemblages including blade industries autonomously emerged in the Korean peninsula, as a form of convergent evolution [@seong2006structure; @seong2008tanged; @seong2009emergence]. To support his claim, @seong2009emergence examined the blade-to-flake ratios of stone artifact assemblages in South Korea. In his view, the blade industry represents a new technology while flakes indicate a continuously-used existing one. He argues that the increased ratio of blades in stone artifact assemblages during the Late Paleolithic shows an expansion of the new technology after its local invention. In addition, Seong claims that increased numbers of stemmed points over time, and standardization of their shape, supports the prominance of gradual, local, evolutionary processes in the emergence of new technologies .

In contrast, the migration model argues that the new blade industry, including stemmed points, and the earlier simple flake tool tradition, including large cores, polyhedrals, choppers and handaxes, came from different origins [@bae2010origin; @bae2012nature; @bae2013early]. While the *in situ* model claims that the heterogenic character is the result of indigenous development, the migration model proposes that it is the result of the continuous influx of modern human populations from both north and south. Specifically, the blade technology in claimed to have been introduced from Siberia, Mongolia, or other regions of northeast China following the Liaohe and Sunghe rivers around 35 ka BP, while the simple flake-tool tradition came from southern China [@bae2013early]. The migration of people from the southern route is supported by genetic studies of the Y chromosome, indicating that the O3-M122 M122 haplotype originated from southern East Asia and moved to northeastern Asia, including Korea, at 30-25 ka BP [@shi2005chromosome]. Bae et al. [-@bae2012nature] assume this southern migration could be related to paleoenvironmental fluctuations during the MIS 3 to 2 transition, which made the Yellow Sea/West Sea region open.

Lee [-@lee2013current] argues that the transition to the Korean Late Paleolithic might be more complicated than either models of migration or *in situ* development. He partly agrees with the *in situ* model that simple flake tools had continuously been used in Korea as the result of ancestor-descendant relationships, under conditions of low effective population size. With regard to the blade industry, he claims that low degrees of uniformity and small quantities of blade-associated toolkits indicate an origin outside of Korea, perhaps resulting from trade or migration. We explore these three options, *in situ*, migration, and a mixture of the two, by measuring transmission biases in assemblages of stemmed points.

# Cultural transmission and transmission biases {.unnumbered}

To measure transmission biases in tool-making, we draw on Darwinian evolutionary theory. This body of theory has helped archaeologists understand a variety of technological innovations and related human behaviors, for example using human behavioral ecology, phylogenetics, cultural transmission theory, and niche construction theory [@dunnell1980evolutionary; @richerson1992cultural; @lipo1997population; @bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @mesoudi2008cultural]. Cultural evolutionary approaches are effective at explaining cultural changes using mechanisms of inheritance, variation-generating processes, and selection. The mechanisms are similar to biological evolution, but in cultural systems they have unique and distinctive properties. Social transmission strongly affects these key evolutionary processes [@Whiten_2017], and can occur through various learning processes, such as stimulus enhancement, emulation, imitation, and teaching [@o2000applying; @schillinger2014copying]. We focus here on how different social contexts can result in different modes of social transmission of tool-making skills among hunter-gather populations.

Cultural transmission theory holds that information about how to behave is acquired through interaction with other individuals and the environment [@boyd1988culture; @richerson1992cultural]. Individuals learn by themselves (e.g. trial and error), or from each other by sharing information. Information can be modified (also known as 'biased') depending on an individual's transmission context and cultural repertoire. Modification of information can occur by recombination, loss, or partial alteration [@eerkens2005cultural; @o2017dual]. Transmission biases can be important loci of changes in material culture, and can be influenced by the social contexts of cultural transmission [@heyes1994social; @eerkens2007cultural; @lycett2015cultural; @creanza2017cultural; @kendal2018social]. These biases include guided variation (where individuals learn new behaviors through trial and error), content-based bias (where some aspect of the transmitted instructions, such as cultural preferences, makes them more likely to be adopted), frequency-based bias (where an individual is biased to choose particular behaviors based on their perceived frequency in the population, such as extremely popular or rare behaviors), and indirect bias (where a behavior is transmitted because of its association with other attributes, such as the prestige or skill of other individuals) [@boyd1988culture; @richerson1992cultural; @o2017dual].

Bettinger and Eerkens [-@bettinger1997evolutionary; -@bettinger1999point; -@eerkens2008cultural] have shown how two of these biases can be identified in stone artifact assemblages. Their research focused on metric variables of stone points during the introduction of bow and arrow technology in the Great Basin around AD 300-600. They equated guided transmission (where individuals learn new behaviors through trial and error) with high metric variation and low correlation between metric attributes. Conversely, they inferred indirect bias (where a behavior is transmitted because of its association with other attributes, such as the prestige or skill of other individuals) from less variation and more correlated variables. They found that artifacts in the new bow and arrow technology in eastern California have low correlations of basal width and mass, which they interpreted as a result of guided transmission dominating the introduction and spread of these tools. From these results, they inferred a social context in eastern California of distant and unfamiliar neighbors, with limited contact between groups to acquire technology directly. In this context of limited contact, they argue that the new technologies developed largely by trial and error. On the other hand, in central Nevada they found that metric variables are highly correlated, indicating that the bow and arrow was introduced and spread by indirect bias.

Following Bettinger and Eerkens' framework, Garvey [-@garvey2018current] uses simulation to explore the degree of standardization represented by coefficient of variation (CV) values of projectile points from the US Southwest and westernmost southern High Plains. Garvey measured CV values of weight, thickness, width and lengths on two types of projectile points, Washita and Fresno points, from the Henderson site. She then computed simulated CV values according to three scenarios of different levels of transmission fidelity (i.e. CV = 10%, 5%, and 3%). The observed metrics of the archaeological projectile points are closest to the metrics of the simulated assemblage with 3% CV, which represents "extremely high-fidelity copying". A CV of 3% is the Weber fraction, or threshold of human visual perception, with variation below this value being too subtle for people to notice [@eerkens2000practice]. Garvey's work shows how the cultural transmission of tool-making behaviours can be measured, simulated, and used to interpret the archaeological record.

Garvey and Bettinger and Eerkens inferred transmission processes from material culture because they were unable to observe them directly. Direct observations have been reported by Mesoudi and O'Brien [-@mesoudi2008cultural] who conducted experimental research using groups of undergraduate students to test the underlying assumptions of Bettinger and Eerkens' study. They simulated model-based bias in projectile point making by providing the design of a model and information of the model's prior success to their research participants. They also simulated guided variation by allowing their participants to explore their own designs. They observed that the majority of participants who were able to choose the previous design copied the most-successful model. Metric attributes of the points made when copied from successful models were more highly correlated than attributes of points made by trial and error. Mesoudi and O'Brien's experimental results are important because they confirm the robustness of previous assumptions about cultural transmission biases, and validate the connection between material culture variation and cultural transmission biases.

# Modeling the social context of the appearance of stemmed points in the Late Paleolithic of Korea {.unnumbered}

Inspired by Bettinger and Eerkens' approach, we use two contrasting transmission modes, guided variation and indirect bias, to investigate the spread of stemmed point technology during the Korean Late Paleolithic period. We propose a spectrum on which we can locate foraging groups and how they started to make stemmed points, depending on their degree of social isolation or social connectedness. On one end of the spectrum we have socially isolated groups who made stemmed points entirely stimulated by guided variation; and on the other end of the spectrum we have socially connected groups whose knowledge of stemmed points derived from indirect bias on the transmission process.

To contextualize this further, on one end of our spectrum we have socially isolated groups who stayed in physically remote places from other groups, or had unfamiliar neighbors with limited contact between groups. Our assumption for this social context is that individuals or groups acquired the technology of stemmed points by modifying existing flake tool forms through trial-and-error processes to solve problems relating to resource procurement (cf. Seong's *in situ* model). This trial and error behavior is expected to have left a distinctive signature on metric variables of the stemmed points. If trial and error was the dominant bias in the transmission of knowledge about how to make stemmed points, we expect that the morphological attributes on a stemmed point will be poorly correlated and show high variation within assemblages and between sites.

On the other end of our spectrum, we have socially connected groups that occupied places close to other groups or had regular contact with other groups. Relatively high degrees of social connectivity provide frequent opportunities for observing others and acquiring information. Individuals or groups learned the technology of stemmed points by copying a model from another individual or group. In this scenario, the model, or ideal, stemmed point is likely to have been a highly successful and frequently chosen one, and learners copy all information about the point design as a package (cf. Bae's migration model). In this social context, indirect bias is the dominant influence on transmission of lithic technology. If indirect bias was prominent in the Korean Paleolithic, we expect that stemmed points should be more standardized, and attributes on the stemmed points will be more correlated, and assemblages from multiple sites will show less variance between and within them.

# Materials and methods {.unnumbered}

```{r}
#| label: summary-of-data

library(tidyverse)
library(ggplot2)
library(ggbeeswarm)

# import the cleaned data ready to work on
load(here::here("analysis/data/derived_data/data_main.RData"))

# how many stemmed artefacts per site?
stemmed_points_per_site <-
df_full_sitename %>%
  dplyr::count(full_sitename) %>%
  arrange(desc(n))

# prepare some values to use in the text below
total_number_of_sp <- sum(stemmed_points_per_site$n)
total_number_of_sites <-nrow(stemmed_points_per_site)
total_number_of_assemblages <- NULL # ADD CODE HERE
```

## Materials and stemmed points chronology

After the first discovery of stemmed points at the Seokjangri site in the 1960s, around 300 have been found in nearly 30 sites across Korea (@fig-map). Most sites contain only a few points but a few sites have many more, such as Suyanggae (n = 55), Jingeuneul (n = 99), and Yongsandong (n = 38) [@Kim_2017]. Among these stemmed points, we selected those that are unbroken from the tip to the stem. We excluded artifacts that were recorded as stemmed points but lack a stem. This resulted in a sample of `r total_number_of_sp` stemmed points from 28 assemblages unearthed from `r total_number_of_sites` sites spanning the period 40-17 ka (@tbl-sp-number). The images of the stemmed points were obtained from published excavation reports and by direct photography during our research on local museum collections. We defined multiple assemblages in a site where artifact-bearing deposits were separated by culturally sterile deposits, or where distinct artifact-bearing stratigraphic units could be identified by major differences in the texture, color, and composition of the sedimentary deposits.

To analyse change over time, we used previously developed chronologies that identify three phases in the Korean Late Paleolithic [@seong2015diversity; @Park_2013]. These chronologies were built on radiocarbon ages, and for sites without any, the presence/absence of blades, stemmed point blanks, and toolkit composition. Based on the existence of blade and micro blade and types of stemmed point blanks, we divided the assemblages into three chronological phases: 1) stemmed points made out of flakes and no blades in assemblages, 2) stemmed points made out of blade or flake and the existence of blade in assemblages, and 3) stemmed points made out of blade and the existence of micro blade in assemblages (@tbl-korean-chronology). Applying this division is necessary because some sites such as Yonghodong, Goryeri, Jungmal, and Mungyeong have no radiocarbon dates due to various research limitations. Inferring ages for these sites by analogy to the technological sequences at sites with dates is important for making maximal use of the available archaeological data to increase our sample size. We arranged our `r total_number_of_assemblages` assemblages containing stemmed points in chronological order to analyse them using these three phases to facilitate observations of change over time.

```{r}
#| label: fig-map
#| fig-cap: Korean Paleolithic sites mentioned in this study
#| fig-width:   4.45
#| fig-height:  4.5

# This script draws the map, this is figure 1 in the paper.

korean_archaeological_site_locations <-
  readr::read_csv(here::here("analysis/data/raw_data/sitelocation.csv"))

korean_archaeological_site_locations <-
  tibble::rowid_to_column(korean_archaeological_site_locations, "ID")

# load map tiles we previously saved, we got these using the code in 
# 000-download-map-tiles.R

library(ggrepel)
# devtools::install_github('3wen/legendMap')
library(legendMap)
library(sp)
library(ggmap)

# load map tiles we previously saved
map <- readRDS(here::here("analysis/data/raw_data/map_tiles.rds"))

# map with site names next to the points
map_of_sites <-
  ggmap(map)  +
  geom_point(data = korean_archaeological_site_locations,
             aes(long_dd ,
                 lat_dd),
             colour = "red",
             size = 2) +

# label points with site name
  geom_text_repel(data = korean_archaeological_site_locations,
                  aes(long_dd ,
                      lat_dd,
                      label = full_sitename),
                  size = 2,
                  bg.color = "white",
                  bg.r = 0.15) +
  theme_minimal(base_size = 6) +
  labs(x = "Longitute",
       y = "Latitude") +
  legendMap::scale_bar(
    # edit these numbers to select a suitable location
    # for the scale bar where it does not cover
    # important details on the map
    lon = 124.5,
    lat = 33.5,
    legend_size = 2,
    # distance of one section of scale bar, in km
    distance_lon = 50,
    # height of the scale bar, in km
    distance_lat = 5,
    # distance between scale bar and units, in km
    distance_legend = 20,
    # units of scale bar
    dist_unit = "km",
    # add the north arrow
    orientation = TRUE,
    # length of N arrow, in km
    arrow_length = 60,
    # distance between scale bar & base of N arrow, in km
    arrow_distance = 50,
    # size of letter 'N' on N arrow, in km
    arrow_north_size = 10) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank())

# inset world map, from
# https://stackoverflow.com/a/62104396/1036500
library(maps)
library(magrittr)
library(maptools)
library(raster)

#Defining a general CRS
mycrs <- "+proj=longlat +datum=WGS84 +no_defs"

#Using the original maps package, then converting map into SpatialPolygons object
world <- maps::map("world", fill=TRUE,  plot = FALSE) %$%
  maptools::map2SpatialPolygons(., IDs=names,proj4string=CRS(mycrs))

#The resulting map has self intersection problems so any further operation reports errors; using buffers of width 0 is a fast fix
while(rgeos::gIsValid(world)==FALSE){
  world <- rgeos::gBuffer(world, byid = TRUE, width = 0, quadsegs = 5, capStyle = "ROUND")
}

#Dissolving polygon's limits
world <- raster::aggregate(world)

#Plotting. I add theme_void to your code to erase any axis, etc
worldplot <-
  ggplot() +
  geom_polygon(data = world,
               aes(x=long, y=lat,
                   group=group),
               fill='NA',
               color='black',
               size=0.1) +
  annotate("rect",
           xmin = 118,
           xmax = 137,
           ymin = 28,
           ymax = 47,
           fill = NA,
           colour = "red",
           size = 0.5
  ) +
  theme_void() +
  coord_fixed(1) +
  labs(x = "", y = "") +
  labs(x = NULL, y = NULL, title = NULL) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme(panel.background = element_rect(fill = "white"),
        panel.border = element_blank(),
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())

# combine site map and inset map
library(cowplot)
ggdraw() +
  draw_plot(map_of_sites) +
  draw_plot(plot = worldplot,
            x = 0.45, # x location of inset placement
            y = -0.27, # y location of inset placement
            width = .6, # Inset width
            height = .75, # Inset height
            scale = 0.5 # Inset scale
  ) +
  theme(panel.background = element_rect(fill='white', colour="white"),
        plot.background = element_rect(fill='white', colour="white"))
```

\newpage

```{r}
#| label: tbl-sp-number
#| tbl-cap: Total number of stemmed points found in sites and the number of stemmed points we used in the research. We excluded broken and unclear artifacts.

here::here("analysis/data/raw_data/site-total-artifacts.csv") %>% 
  read_csv() %>% 
  knitr::kable(.)

```

\newpage

```{r}
#| label: tbl-korean-chronology
#| tbl-cap: Korean Paleolithic Chronology edited based on Seong [-@seong2015diversity] and Park [-@Park_2013]

here::here("analysis/data/raw_data/Korean-paleolithic-chronology.csv") %>% 
  read_csv() %>% 
  knitr::kable(.)

```

\newpage

## Methods

In addition to the metric attributes from previous studies of cultural transmission and projectile points, i.e. maximum length and width [@bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @garvey2018current], we also used morphological attributes on the stemmed points to examine variations in shape and the relationship between each attribute (@fig-labelled-schematic). We obtained our morphological attribute data from landmark analysis of digitized images of stemmed points. Compared to traditional caliper measurements, morphometric data yields more easily interpretable numerical and visual outcomes [@buchanan2010geometric; @thulman2012discriminating; @cardillo2016environment; @petvrik2018shape; @macleod2018quantitative; @okumura2019archaeology; @suarez2019life]. We did not include weight and thickness as these measurements were not available to us. For the landmark analysis, we put a total of 11 landmarks on the outline of each stemmed point and computed distances between pairs of landmark coordinates to derive attributes for our statistical analyses. The landmarks we recorded are described in @tbl-landmark-abbreviations and shown in @fig-labelled-schematic. We used the point tool in ImageJ [@schneider2012nih] to capture the landmarks from images of the artefacts, and export them as XY coordinate data for further analysis.

\newpage

```{r}
#| label: fig-labelled-schematic
#| fig-cap: Stemmed point from Yongsandong site. with landmarks showing the attributes considered in this study and corresponding landmarks
#| out-width: "300px"

knitr::include_graphics(here::here("analysis/figures/hand-made-figures/ISKM-talk-2021-cut.png"))

```

\newpage

```{r}
#| label: tbl-landmark-abbreviations
#| tbl-cap: Description of artefact landmarks used in this study

here::here("analysis/data/raw_data/table-of-landmark-abbreviations.csv") %>% 
  read_csv() %>% 
  knitr::kable(.)

threshold_value <- 25

```

\newpage

To measure the variation among the measurements of the stemmed points, we computed Coefficients of Variation (CV) with confidence intervals. The CV is the ratio of the standard deviation to the mean. It has been used as a robust statistical method to calculate the degree of standardization, precision, equality, homogeneity, etc. in various disciplines [@ng2006performance; @panichkitkosolkul2009improved; @panichkitkosolkul2013confidence]. In archaeological studies, CV has been applied to measure the variation between artifacts and to test hypotheses about cultural evolutionary processes, including distinguishing between different types of learning biases affecting cultural transmission [@eerkens2001techniques; @eerkens2005cultural; @schillinger2014copying; @garvey2018current]. Eerkens and Bettinger [-@eerkens2001techniques] summarized CV values for artifacts made from various materials and find that the range of CV values for most archaeological datasets is between 2 (i.e. CV for planned production = 1.7) and about 60 (i.e. CV for random production = 57.7) and the values over the upper limit likely reflect  attempts to intentionally differentiate the products. Among the Great Basin projectiles examined by Eerkens and Bettinger, the average CV was 22 and the range in CV values was 6-55. Considering the lower quality of raw materials in Korea compared to the Great Basin, and the median of the CV range (30.5) for the Korean lithics, we selected `r threshold_value` as the threshold to decide between guided variation and indirect bias. We premised that CV values that are lower than `r threshold_value` represent guided variation while CV values over `r threshold_value` reflect indirect bias. <!-- I STILL THIS WE NEED A MORE COMPELLING JUSTIFICATION FOR THE THRESHOLD VALUE, BASED ON SOME THEORY IN THE LITERATURE. I EXPECT REVIEWERS WILL GET STUCK ON THIS AND DEMAND MORE DETAILS. THE CHOICE OF VALUE HAS A HUGE EFFECT ON OUR INTERPRETATIONS BELOW -->

Sample size can impact the accuracy of CV estimates [@toebe2018sample; @kelley2007sample; @vanpool2011quantitative]. In previous archaeological studies, sample sizes for CV values has varied from five to more than a thousand artifacts [@bettinger1999point; @garvey2018current; @costin1995standardization; @wierer2013variability; @kvamme1996alternative; @rivals2009new]. A variety of methods are available for improving the reliability of CV measurements when using small samples. For example, @vanpool2011quantitative proposed a "corrected CV", for a smaller sample (i.e. n\<25). Statistical research has resulted in several methods for computing confidence intervals on CVs to show uncertainty [@koopmans1964confidence; @miller1991asymptomatic; @sharma1994asymptotic; @mckay1932distribution; @vangel1996confidence; @curto2009coefficient; @banik2011estimating; @panichkitkosolkul2013confidence; @mahmoudvand2009two; @gulhar2012comparison]. Although we have a total of `r total_number_of_sp` artifacts, most of our analyses here involves comparisons of smaller subsets of this sample. For example to explore temporal and regional patterns we compared samples of well under 25 pieces. Given these relatively small sample sizes in our study, we used the corrected CV formula, which we have implemented here in a function in the R programming language for others to use. We also computed confidence intervals using method proposed by @sharma1994asymptotic to increase the credibility of the comparisons and be transparent about the precision and accuracy of our results [@kelley2007sample; @albatineh2014confidence].

To compute correlations between the attributes [@bettinger1999point; @eerkens2008cultural; @garvey2018current], we used Principal Component Analysis (PCA). PCA is commonly used to detect correlations among multiple variables, and has the advantage of allowing us to investigate the relationship between attributes as well as the impact of each attribute on the overall shape of stemmed points. PCA is often used to reduce dimensionality, detect patterns and clusters in data, indicate relationships between variables as well as cases, and identify which variables most influence these patterns [@cascalheira2018use; @suarez2019life]. PCA is widely used for geometric morphometric analysis of artifacts to extract general patterns of shape variation [@selden2014advances; @suarez2019life; @leplongeon2020backed; @ivanovaite2020all].

All data preparation, analyses and visualization were computed in the R environment [@RCoreTeam]. Our R code and data, including the original artefact images, are fully and openly available in our compendium [@Marwick2018compendium] online at https://doi.org/10.17605/osf.io/eb8mx to enable transparency and reproducibility [@marwick2017computational].

# Results {.unnumbered}

```{r}
#| label: prepare-for-cv-calcs

# Coefficient of variation (CV): the ratio of the standard deviation divided by mean

# cv <- function(x, ... ) sd(x, ...) / mean(x, ...) * 100

# use this one that is optimized for small samples, returns value 0-1, not % 

mccv <- function(x, ... ) sd(x, ...) / mean(x, ...) * (1 + 1/(4*length(x)))

# BM: this is the cvCI function from https://github.com/stamats/MKmisc, I 
# removed all the non-sharma methods and replaced CV() with mccv() above

sharma_cvCI <- function(x, 
                 conf.level = 0.95, 
                 method = "sharma", 
                 na.rm = FALSE){
    stopifnot(is.numeric(x))

    if(length(conf.level) != 1)
        stop("'conf.level' has to be of length 1 (confidence level)")
    if(conf.level < 0.5 | conf.level > 1)
        stop("'conf.level' has to be in [0.5, 1]")

    alpha <- 1 - conf.level
    zquant <- qnorm(1-alpha/2)
    cv <- mccv(x = x, na.rm = na.rm)
    Infos <- NULL
    if(na.rm) x <- x[!is.na(x)]
    n <- length(x)

     # Sharma and Krishna 1994
      CI.lower <- 1/(1/cv + zquant/sqrt(n))
      CI.upper <- 1/(1/cv - zquant/sqrt(n))
      METH <- "Sharma and Krishna (1994) confidence interval"
    
    CI <- matrix(c(CI.lower, CI.upper), nrow = 1)
    rownames(CI) <- "CV"
    colnames(CI) <- c(paste(alpha/2*100, "%"), paste((1-alpha/2)*100, "%"))
    attr(CI, "conf.level") <- conf.level
    names(cv) <- "CV"

    return(structure(list("estimate" = cv, "conf.int" = CI, "Infos" = Infos,
                          "method" = METH),
                     class = "confint"))
}
```

```{r}

# we've got DF a data frame with cols as variables
# rows and specimens, and values as dimensions
# need to add a column of site ID

DFCV <- map_dbl(DF, mccv)

#Same as map but better view for summary
cv_all <- map_df(DF, mccv)
#arrange the data properly
cv_data_all <- gather(cv_all)

# to install MKmisc
## Install package BiocManager
# install.packages("BiocManager")
## Use BiocManager to install limma
# BiocManager::install("limma")
# install.packages("MKmisc")

library(MKmisc)
library(purrr)
# CV value
sharma_cv <- function(x,...) sharma_cvCI(x, conf.level = 0.95, method = "sharma", na.rm = FALSE)$estimate*100

#CV sharma interval values
sharma_int_low <- function(x,...) sharma_cvCI(x, conf.level = 0.95, method = "sharma", na.rm = FALSE)$conf.int[1] * 100

sharma_int_high <- function(x,...) sharma_cvCI(x, conf.level = 0.95, method = "sharma", na.rm = FALSE)$conf.int[2] * 100

all_cv_sharma <- map_dbl(DF, sharma_cv)
all_low_sharma <- map_dbl(DF, sharma_int_low)
all_high_sharma <- map_dbl(DF, sharma_int_high)

#create data frame
cv_data_sharma <- data.frame(all_cv_sharma, all_low_sharma, all_high_sharma)

#add column name
library(tibble)
cv_data_sharma_named <- rownames_to_column(cv_data_sharma, var = "attribute")

# for in-text numbers
max_cv <- round(max(cv_data_sharma_named$all_cv_sharma), 1)
min_cv <- round(min(cv_data_sharma_named$all_cv_sharma), 1)

```

```{r}
#| label: fig-plot-attributes
# Box plot for each attribute
# mutate data to make plot with ggplot
data_box <- gather(DF)
# make box plot for each attributes
plot_raw_measurements_for_attributes <- 
ggplot(data_box,
       aes(key, value)) +
  geom_boxplot() +
  geom_beeswarm(alpha = 0.3,
                size = 0.8,
                cex = 0.7) +
  ylab("Length (cm)") +
  xlab("") +
  theme_bw()
```

Panel A of @fig-plot-cv-all-attributes shows a relatively wide distribution of body length (BL) and maximum length (ML) while the other attributes are more similar and shorter (under 2.5 cm). Among these attributes, stem width (SW) is the smallest, regardless of overall size of the stemmed points. This result may imply that the stem width was the most constrained dimension of the artefact. We might speculate that this is due to the requirements of halfting with wooden shafts, where the shafts were selected from a small range of diameters that optimised strength, weight and flexibility.

## Coefficient of variation

Our results show that CV values for all attributes are distributed from `r min_cv` to `r max_cv` (@fig-plot-cv-all-attributes). Compared to the CVs of Great Basin projectile points [@eerkens2001techniques], the average CV for the Korean artefacts is higher. Unlike the distribution of the linear measurements, the CVs of body length and maximum length have the lowest values. The lower CV of maximum length indicates they are highly standardized with narrowest confidence intervals. Tang and stem related attributes (e.g. SL, SW, TL, TW) are less standardized with higher CV values and wider confidence intervals than other attributes Among all the attributes, only maximum length has the CV values lower than 25, which suggests the transmission of this attribute was influenced by indirect bias.

```{r}
#| label: fig-plot-cv-all-attributes
#| fig-cap: A. Boxplot for each attribute measured on the stemmed points. The black bold horizontal lines in the middle of boxes represent the median value. The dots represent individual artefacts. B. The points and blue colored numbers represent CV values for each attribute measured on the stemmed points. 95% confidence intervals for the CVs were computed using Sharma and Krishna's method. The vertical lines indicate the range of confidence intervals.

#| fig-width:7
#| fig-height:4

plot_cv_all_attributes <- 
ggplot(cv_data_sharma_named,
       aes(attribute,
           all_cv_sharma)) +        # ggplot2 plot with confidence intervals
  geom_point() +
  geom_errorbar(aes(ymin = all_low_sharma, 
                    ymax = all_high_sharma), 
                width = 0.2) +
  ylab("CV") +
  xlab("Artefact measurement") +
  geom_text(aes(label = round(all_cv_sharma,1)), 
            col="blue", 
            hjust = -0.3, 
            size = 3) +
  # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value, colour = "red") +
  theme_bw()

library(cowplot)
plot_grid(plot_raw_measurements_for_attributes,
          plot_cv_all_attributes,
          ncol = 1, 
          labels = "AUTO")
```

## Variation Over Time

To understand temporal patterns in the modes of cultural transmission, we grouped our assemblages into the three Korean Late Paleolithic chronological phases summarised in @tbl-korean-chronology, and computed CV values for all complete stemmed points each phase. We excluded Phase 1 from our analysis because there are only two complete stemmed points from Yonghodong and Sachang that date to this phase.

@fig-plot-cv-over-time shows that the directional trend in CV values of artefact attributes is complicated. Half of the attributes are below our threshold value of `r threshold_value`, and half are above. Only body length crosses the threshold value, changing from <`r threshold_value` to >`r threshold_value` over time, indicating a shift from indirect bias to guided variation. For those attributes where the CV is <`r threshold_value`, the trend is decreasing CV values from Phase 2 to Phase 3 for maximum width and tang length, indicating increasing influence of indirect bias for these attributes. For stem length, stem width and tang length, CV values remain above `r threshold_value`, and show a slight trend to increase over time, suggesting increased influence of guided variation for these attributes. 

\newpage

```{r}
#| label: fig-plot-cv-over-time
#| fig-cap: CV values for the second and third chronological phases in the Korean Late Paleolithic period. The points represent CV values for each attribute. The vertical lines indicate the range of confidence intervals.
#| fig-width:   4.5
#| fig-height:  4.5

#-- temporal patterns ----------------------------------------------------------------
# Make a table of CVs for all variable grouped by stage, according to
# stemmed point chronology
# Exclude the first phase that has only two artefacts

cv_by_stage_df  <-
  df_sitename %>%
  dplyr::select(-sitename,
         -SPstage.Raw_material) %>%
  group_by(SPstage.Stage) %>%
  add_tally() %>%
  dplyr::filter(SPstage.Stage > 1) %>%
  dplyr::select(-n) %>%
  pivot_longer(-SPstage.Stage,
               names_to = "variable",
               values_to = "value") %>%
  group_by(SPstage.Stage, variable) %>%
  dplyr::summarise(cv_by_site =   sharma_cv(value),
            cv_low_sharma =  sharma_int_low(value),
            cv_high_sharma = sharma_int_high(value))

# facet plot for two phases
cv_by_stage_df %>%
  ggplot(aes(x = factor(SPstage.Stage),
             y = cv_by_site)) +
  geom_point() +
  geom_errorbar(aes(ymin = cv_low_sharma,
                    ymax = cv_high_sharma),
                width = 0.2) +
  xlab("Phase") +
  ylab("Coefficient of Variation for all Attributes") +
    # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value, colour = "red") +
  facet_wrap( ~ variable, scales = "free_y") +
  theme_bw()
```

One limitation of this aggregation of all stemmed points in our sample into each chronological phase is that the sample consists of a relatively large number of assemblages with only 1-2 stemmed points. These isolated finds are ambiguous with respect to a local tradition of artefact making, so to further investigate temporal change, we focus only the four assemblages that have five or more stemmed points in one chronological phase (@fig-plot-cv-over-time). These four assemblages are more likely to represent a consistent, recurring way of making stemmed points than isolated finds, and thus more relevant for comparing modes of cultural transmission of artefact making. The four assemblages include three from the Suyanggae site (SYG) and one from the Yongsandong site (YS). SYG1_2 and SYG6_2 are from Phase 2 (shown on the left side of the figure) and SYG1_3 and YS_3 are from Phase 3 (shown on the right side of the figure). Following the previous studies of [@bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @mesoudi2008cultural; @garvey2018current], we only compared CV values of attributes, body length, maximum length, mid width, and tang width. @fig-plot-cv-four-assemblage shows that CV values for the four assemblages are mostly below `r threshold_value`, which represent transmissions dominated by indirect bias. Among the assemblages, SYG1_2 (n=7) has higher CV values as well as the widest ranges of confidence intervals, perhaps due to its small sample size, relative to the other assemblages compared here. Overall we see only subtle changes in CV values from Phase 2 to Phase 3 in @fig-plot-cv-over-time. This suggests that the complex directional trends in @fig-plot-cv-over-time might be best interpreted as noise in an overall signal of indirect bias, rather than substantial changes in the type of bias dominating cultural transmission. 

```{r}
#| label: fig-plot-cv-four-assemblage
#| fig-cap: CV values of four attributes from assemblages that more than 5 stemmed points. Among the four assemblages, SYG1_2 and SYG6_2 are from Phase 2 of the Korean Late Paleolithic chronology and SYG1_3 and YS_3 are from Phase 3.
#| fig-width:   4.5
#| fig-height:  4.5

#### plot CVs by site with number of artefacts showing >5

cv_by_site_df_label_more_than_5 <-
  df_sitename %>%
  unite(col = "site_phase",
        c(sitename,
          SPstage.Stage),
        sep = "_") %>%
  dplyr::select(-SPstage.Raw_material) %>%
  dplyr::group_by(site_phase) %>%
  add_tally() %>%
  dplyr::filter( n > 5) %>%
  mutate(label = as.factor(paste0(site_phase,' (N = ', n, ")"))) %>%
  ungroup() %>%
  dplyr::select(-n, -site_phase) %>%
  pivot_longer(-label,
               names_to = "variable",
               values_to = "value") %>%
  dplyr::group_by(label, variable) %>%
  dplyr::summarise(cv_by_site =   sharma_cv(value),
            cv_low_sharma =  sharma_int_low(value),
            cv_high_sharma = sharma_int_high(value)) %>%
  dplyr::filter(variable %in% c("ML", "BL","MW", "TW"))

cv_by_site_df_label_more_than_5 %>%
  ggplot(aes(x = factor(variable),
             y = cv_by_site)) +
  geom_point() +
  geom_errorbar(aes(ymin = cv_low_sharma,
                    ymax = cv_high_sharma), width = 0.2) +
    # draw a line to show our threshold value
  geom_hline(yintercept = threshold_value, colour = "red") +
  xlab("Attribute") +
  ylab("Coefficient of Variation on Attributes") +
  facet_wrap( ~ label, scales = "free_y") +
  coord_cartesian(ylim = c(15,60)) +
  theme_bw()

```

## Variation Between sites

We examined the CV values per site to address our research question about the cultural transmission over space. We excluded assemblages that contain less than five points. @fig-plot-cv-by-site shows higher CV values for stem length and stem width, indicating high variability at the stem of the points from these sites. Overall size variability is similar between these three assemblages, suggesting a consistent approach to constraining shape variation over space, rather than site-specific variances. 

```{r}
#| label: fig-plot-cv-by-site
#| fig-cap: CV values per site that has more than five stemmed points. The points represent CV values for each attribute. The vertical lines are confidence intervals.
#| fig-width:   8.5
#| fig-height:  4.5

cv_by_site_df  <-
  df_full_sitename %>%
  dplyr::select(-SPstage.Stage, 
                -lat_dd, 
                -long_dd, 
                -sitename, 
                -SPstage.Raw_material) %>%
  group_by(full_sitename) %>%
  add_tally() %>%
  dplyr::filter( n > 5) %>%
  dplyr::select(-n) %>%
  pivot_longer(-full_sitename,
               names_to = "variable",
               values_to = "value") %>%
  group_by(full_sitename, variable) %>%
  dplyr::summarise(cv_by_site =   sharma_cv(value),
            cv_low_sharma =  sharma_int_low(value),
            cv_high_sharma = sharma_int_high(value))

## CV for per each site (n=X) with the full site name : label

cv_by_full_site_df_label <-
  df_full_sitename %>%
  dplyr::select(-SPstage.Stage) %>%
  group_by(full_sitename) %>%
  add_tally() %>%
  dplyr::filter( n > 1) %>%
  mutate(label = as.factor(paste0(full_sitename,' (N = ', n, ")"))) %>%
  dplyr::select(-n) %>%
  nest(-full_sitename, -label) %>%
  dplyr::mutate(cv_by_site = purrr::map(data, ~map_df(.x, mccv))) %>%
  dplyr::select(-cv_by_site)

## add label to main dataframe

cv_plot_site_label <- cv_by_site_df %>%
  left_join(cv_by_full_site_df_label) %>%
  dplyr::select(- data,-full_sitename)

## facet plot

cv_plot_site_label %>%
  ggplot(aes(x = variable,
             y = cv_by_site)) +
  geom_point() +
  geom_errorbar(aes(ymin = cv_low_sharma,
                    ymax = cv_high_sharma),
                width = 0.2) +
  xlab("Attribute") +
  ylab("Coefficient of Variation on Attributes") +
    # draw a line to show our threshold value
  geom_hline(yintercept = 25, colour = "red") +
  facet_wrap( ~ label, scales = "free_y") +
  theme(legend.position = "none") +
  coord_cartesian(ylim = c(0,100)) +
  theme_bw() +
  theme(strip.text.x = element_text(size = 6.5))
```

## Variation Between Raw Materials

We examined the relationship between CV values and raw materials to test the hypothesis that the shape of stemmed points was highly dependent on raw material. We excluded raw materials that were used for less than three points. @fig-plot-cv-by-raw-material shows that quartzite, the raw materials for stemmed points at Sachang, has the highest CV value with a wide range of conference intervals. Other raw materials are generally stable in variation throughout the attributes.

```{r}
#| label: fig-plot-cv-by-raw-material
#| fig-cap: CV values for raw materials that were used for making more than one stemmed point. The points represent CV values for each attribute. The vertical lines indicate the range of confidence intervals.
#| fig-width:   8.5
#| fig-height:  4.5

# CV by raw materials
### Make a table of CVs for all variable grouped by raw materials
cv_by_raw_materials <-
  df_full_sitename %>%
  dplyr::select(-SPstage.Stage, -lat_dd, -long_dd, -sitename, -full_sitename) %>%
  group_by(SPstage.Raw_material) %>%
  add_tally() %>%
  dplyr::filter( n >= 3) %>%
  dplyr::select(-n) %>%
  pivot_longer(-SPstage.Raw_material,
               names_to = "variable",
               values_to = "value") %>%
  group_by(SPstage.Raw_material, variable) %>%
  dplyr::summarise(cv_by_materials =   sharma_cv(value),
            cv_low_sharma =  sharma_int_low(value),
            cv_high_sharma = sharma_int_high(value))

######CV for per raw materials (n=X) with the full site name : label
cv_by_raw_materials_df_label <-
  df_sitename %>%
  group_by(SPstage.Raw_material) %>%
  add_tally() %>%
  dplyr::filter( n > 1) %>%
  mutate(label = as.factor(paste0(SPstage.Raw_material,' (N = ', n, ")"))) %>%
  dplyr::select(-n) %>%
  nest(-SPstage.Raw_material, -label) %>%
  mutate(cv_by_site = purrr::map(data, ~map_df(.x, mccv))) %>%
  dplyr::select (-cv_by_site)

######add label to main dataframe
cv_plot_raw_materials_label <- cv_by_raw_materials %>%
  left_join (cv_by_raw_materials_df_label) %>%
  dplyr::select (- data,-SPstage.Raw_material)

###### facet plot
cv_plot_raw_materials_label %>%
  ggplot(aes(x = variable, y = cv_by_materials)) +
  geom_point() +
  geom_errorbar(aes(ymin = cv_low_sharma,
                    ymax = cv_high_sharma), width = .2) +
    # draw a line to show our threshold value
  geom_hline(yintercept = 25, colour = "red") +
  xlab("Law Materials") +
  ylab("Coefficient of Variation on Attributes") +
  facet_wrap( ~ label, scales = "free_y") +
  coord_cartesian(ylim = c(0,130)) +
  theme_bw() 
```

## Principal Component Analysis

PCA serves to examine correlation of attributes for determining the dominant mode of cultural transmission. @fig-pca-attributes shows positive relationship between attributes. Especially, there are strong relationships between body length and maximum length, tang width and mid width, and tang length and stem length. Body length and maximum length contribute the most to the shape of stemmed points and they are most correlated to each other. Other width and tang related attributes are close to each other but a bit far from body length and maximum length. Stem width contributes the least to the overall shape. We can assume that the body length and maximum length were prioritized when the manufacturing technique of stemmed points were transmitted.

For the temporal variation, we computed PCA for difference periods. Compared to Phase 2, the influence of tang length and stem length of Phase 3 becomes more pronounced and while stem width is less effective. However, there are no notable changes in correlations over time.

```{r}
#| label: fig-pca-attributes
#| fig-cap: PCA analysis for stemmed points, for all phases combined, then for only phase two and phase three. The direction of the arrow shows the relationship between attributes; arrows pointing in the same direction indicate variables that are highly postitively correlated. The length of the arrow indicates the strength of contribution to the stemmed point shape.
#| fig-width:   7
#| fig-height:  3

library(ggbiplot)
library(ggfortify)
### PCA analysis using ggbiplot, ggfortify pkgs

PCA <- prcomp(DF, center = TRUE, scale = TRUE)

# remove stage 1 artefact
xx_pca <-
  df_sitename %>%
  dplyr::filter(SPstage.Stage != 1) %>%
  dplyr::select(-sitename, -SPstage.Stage, -SPstage.Raw_material) %>%
  prcomp(., center = TRUE, scale = TRUE)

xx_pca1 <-
  data.frame(xx_pca$x,
             stage = as.factor( df_sitename$SPstage.Stage[df_sitename$SPstage.Stage !=1]))

## CV with site (n=X)
label_phase <-
  df_sitename %>%
  group_by(SPstage.Stage) %>%
  add_tally() %>%
  mutate(label = as.factor(paste0(SPstage.Stage,'\nN = ',n)))

count_phase <- length(which(label_phase[9]>0))
count_phase2 <- length(which(label_phase[9] == 2))
count_phase3 <- length(which(label_phase[9] == 3))

# phase 2

xx_pca2 <-
  df_sitename %>%
  dplyr::filter(SPstage.Stage == 2) %>%
  dplyr::select(-sitename, -SPstage.Stage, -SPstage.Raw_material) %>%
  prcomp(., center = TRUE, scale = TRUE)

# phase 3

xx_pca3 <-
  df_sitename %>%
  dplyr::filter(SPstage.Stage == 3) %>%
  dplyr::select(-sitename, -SPstage.Stage, -SPstage.Raw_material) %>%
  prcomp(., center = TRUE, scale = TRUE)

##### using factoextra pkg
library(factoextra) #http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/

# Color variables by the continuous variable
cv_all <-
fviz_pca_var(xx_pca) +
  ggtitle(paste0("All phases", " (n = ", count_phase,")")) +
  theme(legend.position = "none")

# phase 2
cv_two <-
  fviz_pca_var(xx_pca2) +
  ggtitle(paste0("Phase 2", " (n = ", count_phase2,")"))

# phase 3
cv_three <-
  fviz_pca_var(xx_pca3) +
  ggtitle(paste0("Phase 3", " (n = ", count_phase3,")"))

library(patchwork)
cv_all + cv_two + cv_three
```

# Discussion {.unnumbered}

To investigate the social contexts of technological transitions represented by the emergence of stemmed points during the Korean Late Paleolithic, we applied concepts of cultural transmission. We asked three questions to examine the dominant mode of cultural transmission and the transmission process over time: what is the dominant mode of cultural transmission for technological innovation in the Korean Late Paleolithic? Do the modes of cultural transmission vary over time? and Do the modes of cultural transmission vary over space? We focused on two transmission biases: guided variation (socially isolated groups made stemmed points through trial and error) and indirect bias (socially connected groups whose knowledge of stemmed points derived from copying others). We set roughly 25 as our threshold of the CV value to decide between these two types of transmission biases, based on prior work on Great Basin Projectiles [@eerkens2001techniques]. If the CV value is lower than 25, which indicates indirect bias while the value is 25 or higher means guided variation.

The CV values for all stemmed points are mostly over 25, except for maximum length. PCA analysis shows positive relationships between attributes (@fig-plot-cv-all-attributes panel B). We then examined the CV values for chronological phases in the Korean Late Paleolithic period (@fig-plot-cv-over-time). After excluding two stemmed points for the Phase 1 to compute CV due to the small sample size issue, the overall CV values become lower. In addition to the maximum length, body length, mid width, and tang width for the Phase 2 are under 25. We observe the different degree of contribution by each attribute to the shape of stemmed points. For example, tang and stem related attributes have higher CV values compared to the body related attributes. We expect that people chose to emulate the body related attributes and had more freedom to produce the tang and stem related attributes.

Compared to the Phase 2 and 3, we found that there are only minor differences between the two phases. The CV of the two most important attributes, body length and maximum length, slightly increased in Phase 3. The increase is not significant to generalize (p \> 0.05, @tbl-cv-over-time), we explored individual assemblages including multiple stemmed points that could show a more clear pattern. The four assemblages in Suyanggae and Yongsandong sites show that CV values decreased with narrower confidence intervals, which means a high degree of precision (@fig-plot-cv-four-assemblage). This could indicate the stronger connections within the groups during Phase 3.

```{r}
#| label: tbl-cv-over-time
#| tbl-cap: "Summary of significance tests for CV values between the two chronological phases"

####### significant test between the two phases ######
library(cvequality)

# created nested tibble, nest by variable
df_sitename_nested <-
  df_sitename %>%
  dplyr::select(-sitename, -SPstage.Raw_material) %>%
  group_by(SPstage.Stage) %>%
  add_tally() %>%
  dplyr::filter(SPstage.Stage > 1) %>%
  dplyr::select(-n) %>%
  pivot_longer(-SPstage.Stage,
               names_to = "variable",
               values_to = "value") %>%
  ungroup() %>%
  group_by(variable) %>%
  nest()

# apply mslr test to each variable (row with a tibble)
# Krishnamoorthy and Lees (2014) modified signed-likelihood ratio test
# this is a table we can show in the text
table_mslr_test_results_for_phase_differences <-
  df_sitename_nested %>%
  mutate(mslr_result = map_df(data, ~mslr_test(nr = 1e4,
                                               .$value,
                                               .$SPstage.Stage))) %>%
  unnest(mslr_result) %>%
  dplyr::select(-data) %>% 
  # round numeric columns to 3 decimal places
  mutate(across(where(is.numeric), round, 3)) %>% 
  arrange(desc(p_value))

names(table_mslr_test_results_for_phase_differences) <- 
  c("Variable", "MSLR statistic", "p value")

knitr::kable(table_mslr_test_results_for_phase_differences,
             digits = 3)

```

There is no clear pattern variation in CV between the sites. Some sites such as Sachang have very high CV values while other sites including Suyanggae and Jingeunuel have lower CV (@fig-plot-cv-by-site). We assumed that the CV could be impacted by other factors such as the choice of raw materials (@fig-plot-cv-by-raw-material). However, similar to the CV variation for the Phase 2, the results of site variation show that CV of body length, maximum length, mid width, and tang width are generally lower than tang length, stem length, and stem width, indicating the combination of the two biases. The attributes with lower CV values could be taught through indirect bias while the higher CV attributes could be depending more on various manufacturing situations. We assume that the lower CV values of the four attributes could imply that those four attributes are closely associated with the function of the tool so that the knappers wanted to standardize the shape. For example, body length is related to penetration, durability, hardness, and rejuvenation of a projectile point and tang width is connected to wound damage, penetration, durability and hardness [@odell1986experiments; @shea2001experimental; @cheshier2006projectile; @yaroshevich2016projectile; @bebber2017developing; @wood2018wound]. This combination model describes that there were social connections between groups that share the tool production technique. Individuals or groups learned the major technology of stemmed points by copying a model from another individual or group (indirect bias). Then, those individuals or groups adjusted their technique and shape of the stem depending on their needs and material availability. Our results recalls -@lee2013current's model but his model explains combination of the *in situ* tradition for flake tools and introduction of blade-associate toolkit including stemmed points. On the other hand, we saw the combination of the *in situ* tradition and introduced stemmed point technology within the single artifact.

# Conclusion {.unnumbered}

In this research, we examine the dominant mode of cultural transmission that might impact technological innovation in the Korean Late Paleolithic. Following the previous studies of applying cultural transmission to the introduction of bow and arrow technology in the Great Basin [@bettinger1997evolutionary; @bettinger1999point; @eerkens2008cultural; @garvey2018current], we use two transmission biases, guided variation and indirect bias to scrutinize the transmission process and social contexts. We claim the two scenarios that explains the introduction of new technology: socially isolated groups made stemmed points through trial and error (guided variation) or socially connected groups whose knowledge of stemmed points derived from copying others (indirect bias). We ask three questions: what is the dominant mode of cultural transmission for technological innovation in the Korean Late Paleolithic? do the modes of cultural transmission vary over time? and do the modes of cultural transmission vary over space? To determine transmission biases and answer our research questions, we computed CV and PCA. The higher CV values (i.e. \>=25) and low correlation indicate guided variation while the lower CV while the lower CV values (i.e. \<25) and high correlations represent indirect bias. To offset the small sample issue and increase the credibility of the comparisons, we applied confidence intervals to CV for better estimation.

Our results show that some attributes such as body length, maximum length, mid width, and tang width were transmitted through indirect bias and the other attributes were developed through guided variation. All attributes are positively related and those low variation attributes are more closely associated and highly contribute to the overall shape of the stemmed points. We assume that the guided variation played a more important role at the beginning of the transition based on high CV values of Phase 1. We observe a slight decrease in CV values over time. No clear regional patterns are confirmed. CV values could be depending on raw materials. For example, coarse materials like quartzite have the highest CV values with the widest range of confidence intervals. Overall, we conclude that combination of the two transmission biases well explains the technological transition during the Late Paleolithic. We anticipate that our theoretical approach is applicable to other studies about technological transition and cultural transmission. We used landmarks to earn the dimensional attributes, which has potential for future research with different dimensions by calculating the distance between other sets of the existing landmarks. In our future research, we will focus on understanding actual connection between the assemblages and examining the social networks for sharing technology between the groups such as trades or physical migration to different locations.

# Acknowledgements

<!-- The following line inserts a page break  -->

# CRediT authorship contribution statement

Gayoung Park: Conceptualization, Software, Validation, Formal analysis, Methodology, Resources, Data curation, Writing - original draft, Writing - Review & Editing, Visualization, Project administration.

Ben Marwick: Software, Validation, Formal analysis, Investigation, Writing - Review & Editing, Visualization, Supervision

\newpage

# References {.unnumbered}

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
